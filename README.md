# æ¨±æ¡ƒæˆç†Ÿåº¦æ£€æµ‹æ£€æµ‹ç³»ç»Ÿæºç åˆ†äº«
 # [ä¸€æ¡é¾™æ•™å­¦YOLOV8æ ‡æ³¨å¥½çš„æ•°æ®é›†ä¸€é”®è®­ç»ƒ_70+å…¨å¥—æ”¹è¿›åˆ›æ–°ç‚¹å‘åˆŠ_Webå‰ç«¯å±•ç¤º]

### 1.ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

é¡¹ç›®å‚è€ƒ[AAAI Association for the Advancement of Artificial Intelligence](https://gitee.com/qunshansj/projects)

é¡¹ç›®æ¥æº[AACV Association for the Advancement of Computer Vision](https://gitee.com/qunmasj/projects)

ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

éšç€å…¨çƒäººå£çš„å¢é•¿å’Œäººä»¬ç”Ÿæ´»æ°´å¹³çš„æé«˜ï¼Œæ°´æœæ¶ˆè´¹é‡é€å¹´ä¸Šå‡ï¼Œæ¨±æ¡ƒä½œä¸ºä¸€ç§è¥å…»ä¸°å¯Œä¸”å£æ„Ÿç‹¬ç‰¹çš„æ°´æœï¼Œå—åˆ°è¶Šæ¥è¶Šå¤šæ¶ˆè´¹è€…çš„é’çã€‚ç„¶è€Œï¼Œæ¨±æ¡ƒçš„æˆç†Ÿåº¦ç›´æ¥å½±å“å…¶å¸‚åœºä»·å€¼å’Œæ¶ˆè´¹è€…çš„è´­ä¹°å†³ç­–ï¼Œå› æ­¤ï¼Œå¦‚ä½•å‡†ç¡®ã€å¿«é€Ÿåœ°æ£€æµ‹æ¨±æ¡ƒçš„æˆç†Ÿåº¦æˆä¸ºäº†å†œä¸šç”Ÿäº§å’Œå¸‚åœºé”€å”®ä¸­çš„ä¸€ä¸ªé‡è¦è¯¾é¢˜ã€‚ä¼ ç»Ÿçš„æ¨±æ¡ƒæˆç†Ÿåº¦æ£€æµ‹æ–¹æ³•å¤šä¾èµ–äºäººå·¥è§‚å¯Ÿï¼Œä¸ä»…è€—æ—¶è€—åŠ›ï¼Œè€Œä¸”å—ä¸»è§‚å› ç´ å½±å“è¾ƒå¤§ï¼Œå®¹æ˜“å¯¼è‡´æ£€æµ‹ç»“æœçš„ä¸ä¸€è‡´æ€§å’Œä¸å‡†ç¡®æ€§ã€‚å› æ­¤ï¼Œå¼€å‘ä¸€ç§é«˜æ•ˆã€å‡†ç¡®çš„æ¨±æ¡ƒæˆç†Ÿåº¦æ£€æµ‹ç³»ç»Ÿå…·æœ‰é‡è¦çš„å®é™…æ„ä¹‰ã€‚

è¿‘å¹´æ¥ï¼Œè®¡ç®—æœºè§†è§‰å’Œæ·±åº¦å­¦ä¹ æŠ€æœ¯çš„å¿«é€Ÿå‘å±•ä¸ºå†œä¸šé¢†åŸŸçš„æ™ºèƒ½åŒ–æä¾›äº†æ–°çš„è§£å†³æ–¹æ¡ˆã€‚YOLOï¼ˆYou Only Look Onceï¼‰ç³»åˆ—ç›®æ ‡æ£€æµ‹ç®—æ³•å› å…¶é«˜æ•ˆæ€§å’Œå®æ—¶æ€§ï¼Œåœ¨ç‰©ä½“æ£€æµ‹ä»»åŠ¡ä¸­è¡¨ç°å‡ºè‰²ã€‚YOLOv8ä½œä¸ºè¯¥ç³»åˆ—çš„æœ€æ–°ç‰ˆæœ¬ï¼Œè¿›ä¸€æ­¥æå‡äº†æ£€æµ‹ç²¾åº¦å’Œé€Ÿåº¦ï¼Œæˆä¸ºäº†è¿›è¡Œæ°´æœæˆç†Ÿåº¦æ£€æµ‹çš„ç†æƒ³é€‰æ‹©ã€‚ç„¶è€Œï¼Œé’ˆå¯¹æ¨±æ¡ƒæˆç†Ÿåº¦æ£€æµ‹çš„ç‰¹å®šéœ€æ±‚ï¼ŒYOLOv8ä»éœ€è¿›è¡Œä¸€å®šçš„æ”¹è¿›ï¼Œä»¥é€‚åº”ä¸åŒæˆç†Ÿåº¦æ¨±æ¡ƒçš„ç‰¹å¾è¯†åˆ«ã€‚

æœ¬ç ”ç©¶åŸºäºæ”¹è¿›YOLOv8ç®—æ³•ï¼Œæ„å»ºäº†ä¸€å¥—æ¨±æ¡ƒæˆç†Ÿåº¦æ£€æµ‹ç³»ç»Ÿã€‚è¯¥ç³»ç»Ÿåˆ©ç”¨äº†ä¸€ä¸ªåŒ…å«2600å¼ å›¾åƒçš„æ•°æ®é›†ï¼Œæ•°æ®é›†ä¸­æ¶µç›–äº†ä¸‰ç§æˆç†Ÿåº¦ç±»åˆ«ï¼šåŠæˆç†Ÿæ¨±æ¡ƒã€æˆç†Ÿæ¨±æ¡ƒå’Œæœªæˆç†Ÿæ¨±æ¡ƒã€‚è¿™ä¸€æ•°æ®é›†çš„æ„å»ºä¸ºæ¨¡å‹çš„è®­ç»ƒå’Œæµ‹è¯•æä¾›äº†ä¸°å¯Œçš„æ ·æœ¬ï¼Œç¡®ä¿äº†æ¨¡å‹åœ¨ä¸åŒæˆç†Ÿåº¦æ¨±æ¡ƒè¯†åˆ«ä¸Šçš„å‡†ç¡®æ€§å’Œé²æ£’æ€§ã€‚é€šè¿‡å¯¹æ•°æ®é›†çš„æ·±å…¥åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥æå–å‡ºæ¨±æ¡ƒåœ¨ä¸åŒæˆç†Ÿåº¦é˜¶æ®µçš„è§†è§‰ç‰¹å¾ï¼Œè¿›è€Œä¸ºæ¨¡å‹çš„æ”¹è¿›æä¾›ç†è®ºä¾æ®ã€‚

æ­¤å¤–ï¼Œæ¨±æ¡ƒæˆç†Ÿåº¦æ£€æµ‹ç³»ç»Ÿçš„ç ”ç©¶ä¸ä»…èƒ½å¤Ÿæé«˜æ¨±æ¡ƒçš„å¸‚åœºç«äº‰åŠ›ï¼Œè¿˜èƒ½ä¸ºæœå†œæä¾›ç§‘å­¦çš„é‡‡æ‘˜å»ºè®®ï¼Œå‡å°‘èµ„æºæµªè´¹ï¼Œæå‡ç”Ÿäº§æ•ˆç‡ã€‚é€šè¿‡è‡ªåŠ¨åŒ–çš„æˆç†Ÿåº¦æ£€æµ‹ï¼Œæœå†œå¯ä»¥åœ¨æœ€ä½³é‡‡æ‘˜æ—¶æœºè¿›è¡Œé‡‡æ‘˜ï¼Œä»è€Œç¡®ä¿æ¨±æ¡ƒçš„å“è´¨å’Œå£æ„Ÿï¼Œæ»¡è¶³æ¶ˆè´¹è€…çš„éœ€æ±‚ã€‚åŒæ—¶ï¼Œè¯¥ç³»ç»Ÿçš„åº”ç”¨ä¹Ÿå°†æ¨åŠ¨å†œä¸šæ™ºèƒ½åŒ–çš„å‘å±•ï¼Œä¿ƒè¿›å†œä¸šä¸ä¿¡æ¯æŠ€æœ¯çš„æ·±åº¦èåˆï¼Œä¸ºå®ç°å¯æŒç»­å†œä¸šæä¾›æœ‰åŠ›æ”¯æŒã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒåŸºäºæ”¹è¿›YOLOv8çš„æ¨±æ¡ƒæˆç†Ÿåº¦æ£€æµ‹ç³»ç»Ÿçš„ç ”ç©¶ï¼Œä¸ä»…å…·æœ‰é‡è¦çš„ç†è®ºä»·å€¼ï¼Œè¿˜å…·å¤‡å¹¿æ³›çš„åº”ç”¨å‰æ™¯ã€‚é€šè¿‡æå‡æ¨±æ¡ƒæˆç†Ÿåº¦æ£€æµ‹çš„å‡†ç¡®æ€§å’Œæ•ˆç‡ï¼Œèƒ½å¤Ÿæœ‰æ•ˆæ¨åŠ¨æ¨±æ¡ƒäº§ä¸šçš„å‘å±•ï¼Œä¿ƒè¿›å†œä¸šç°ä»£åŒ–è¿›ç¨‹ï¼Œæœ€ç»ˆå®ç°ç»æµæ•ˆç›Šä¸ç¤¾ä¼šæ•ˆç›Šçš„åŒèµ¢ã€‚

### 2.å›¾ç‰‡æ¼”ç¤º

![1.png](1.png)

![2.png](2.png)

![3.png](3.png)

##### æ³¨æ„ï¼šç”±äºæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ2.å›¾ç‰‡æ¼”ç¤ºâ€å’Œâ€œ3.è§†é¢‘æ¼”ç¤ºâ€å±•ç¤ºçš„ç³»ç»Ÿå›¾ç‰‡æˆ–è€…è§†é¢‘å¯èƒ½ä¸ºè€ç‰ˆæœ¬ï¼Œæ–°ç‰ˆæœ¬åœ¨è€ç‰ˆæœ¬çš„åŸºç¡€ä¸Šå‡çº§å¦‚ä¸‹ï¼šï¼ˆå®é™…æ•ˆæœä»¥å‡çº§çš„æ–°ç‰ˆæœ¬ä¸ºå‡†ï¼‰

  ï¼ˆ1ï¼‰é€‚é…äº†YOLOV8çš„â€œç›®æ ‡æ£€æµ‹â€æ¨¡å‹å’Œâ€œå®ä¾‹åˆ†å‰²â€æ¨¡å‹ï¼Œé€šè¿‡åŠ è½½ç›¸åº”çš„æƒé‡ï¼ˆ.ptï¼‰æ–‡ä»¶å³å¯è‡ªé€‚åº”åŠ è½½æ¨¡å‹ã€‚

  ï¼ˆ2ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®æ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«æ¨¡å¼ã€‚

  ï¼ˆ3ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®æ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«ç»“æœä¿å­˜å¯¼å‡ºï¼Œè§£å†³æ‰‹åŠ¨å¯¼å‡ºï¼ˆå®¹æ˜“å¡é¡¿å‡ºç°çˆ†å†…å­˜ï¼‰å­˜åœ¨çš„é—®é¢˜ï¼Œè¯†åˆ«å®Œè‡ªåŠ¨ä¿å­˜ç»“æœå¹¶å¯¼å‡ºåˆ°tempDirä¸­ã€‚

  ï¼ˆ4ï¼‰æ”¯æŒWebå‰ç«¯ç³»ç»Ÿä¸­çš„æ ‡é¢˜ã€èƒŒæ™¯å›¾ç­‰è‡ªå®šä¹‰ä¿®æ”¹ï¼Œåé¢æä¾›ä¿®æ”¹æ•™ç¨‹ã€‚

  å¦å¤–æœ¬é¡¹ç›®æä¾›è®­ç»ƒçš„æ•°æ®é›†å’Œè®­ç»ƒæ•™ç¨‹,æš‚ä¸æä¾›æƒé‡æ–‡ä»¶ï¼ˆbest.ptï¼‰,éœ€è¦æ‚¨æŒ‰ç…§æ•™ç¨‹è¿›è¡Œè®­ç»ƒåå®ç°å›¾ç‰‡æ¼”ç¤ºå’ŒWebå‰ç«¯ç•Œé¢æ¼”ç¤ºçš„æ•ˆæœã€‚

### 3.è§†é¢‘æ¼”ç¤º

[3.1 è§†é¢‘æ¼”ç¤º](https://www.bilibili.com/video/BV1bh44eDEth/)

### 4.æ•°æ®é›†ä¿¡æ¯å±•ç¤º

##### 4.1 æœ¬é¡¹ç›®æ•°æ®é›†è¯¦ç»†æ•°æ®ï¼ˆç±»åˆ«æ•°ï¼†ç±»åˆ«åï¼‰

nc: 3
names: ['half_cherry', 'ripe_cherry', 'unripe_cherry']


##### 4.2 æœ¬é¡¹ç›®æ•°æ®é›†ä¿¡æ¯ä»‹ç»

æ•°æ®é›†ä¿¡æ¯å±•ç¤º

åœ¨ç°ä»£å†œä¸šæŠ€æœ¯çš„å¿«é€Ÿå‘å±•ä¸­ï¼Œè®¡ç®—æœºè§†è§‰æŠ€æœ¯çš„åº”ç”¨ä¸ºå†œä½œç‰©çš„ç®¡ç†å’Œç›‘æµ‹æä¾›äº†æ–°çš„è§£å†³æ–¹æ¡ˆã€‚æœ¬ç ”ç©¶æ‰€é‡‡ç”¨çš„æ•°æ®é›†åä¸ºâ€œCerejasâ€ï¼Œæ—¨åœ¨ä¸ºæ”¹è¿›YOLOv8çš„æ¨±æ¡ƒæˆç†Ÿåº¦æ£€æµ‹ç³»ç»Ÿæä¾›é«˜è´¨é‡çš„è®­ç»ƒæ•°æ®ã€‚è¯¥æ•°æ®é›†ä¸“æ³¨äºæ¨±æ¡ƒçš„æˆç†Ÿåº¦åˆ†ç±»ï¼ŒåŒ…å«ä¸‰ç§ä¸åŒçš„ç±»åˆ«ï¼Œåˆ†åˆ«æ˜¯â€œåŠæˆç†Ÿæ¨±æ¡ƒâ€ã€â€œæˆç†Ÿæ¨±æ¡ƒâ€å’Œâ€œæœªæˆç†Ÿæ¨±æ¡ƒâ€ã€‚è¿™äº›ç±»åˆ«çš„åˆ’åˆ†ä¸ä»…æœ‰åŠ©äºç²¾ç¡®è¯†åˆ«æ¨±æ¡ƒçš„ç”Ÿé•¿çŠ¶æ€ï¼Œè¿˜èƒ½ä¸ºå†œæ°‘æä¾›ç§‘å­¦çš„é‡‡æ‘˜å»ºè®®ï¼Œä»è€Œæé«˜æ¨±æ¡ƒçš„é‡‡æ‘˜æ•ˆç‡å’Œè´¨é‡ã€‚

â€œCerejasâ€æ•°æ®é›†çš„æ„å»ºç»è¿‡ç²¾å¿ƒè®¾è®¡ï¼Œç¡®ä¿æ¶µç›–äº†æ¨±æ¡ƒåœ¨ä¸åŒç”Ÿé•¿é˜¶æ®µçš„å¤šæ ·æ€§ã€‚æ¯ä¸ªç±»åˆ«éƒ½åŒ…å«äº†å¤§é‡çš„å›¾åƒæ ·æœ¬ï¼Œè¿™äº›æ ·æœ¬åœ¨ä¸åŒçš„å…‰ç…§æ¡ä»¶ã€èƒŒæ™¯ç¯å¢ƒå’Œæ‹æ‘„è§’åº¦ä¸‹è¿›è¡Œé‡‡é›†ï¼Œä»¥å¢å¼ºæ¨¡å‹çš„é²æ£’æ€§å’Œæ³›åŒ–èƒ½åŠ›ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ•°æ®é›†èƒ½å¤Ÿæœ‰æ•ˆåœ°æ¨¡æ‹Ÿå®é™…å†œä¸šç¯å¢ƒä¸­çš„å„ç§å¤æ‚æƒ…å†µï¼Œä½¿å¾—è®­ç»ƒå‡ºçš„æ¨¡å‹åœ¨çœŸå®åº”ç”¨ä¸­è¡¨ç°æ›´åŠ ä¼˜å¼‚ã€‚

åœ¨æ•°æ®é›†çš„æ ‡æ³¨è¿‡ç¨‹ä¸­ï¼Œé‡‡ç”¨äº†ä¸“ä¸šçš„æ ‡æ³¨å·¥å…·ï¼Œç¡®ä¿æ¯ä¸€å¼ å›¾åƒéƒ½ç»è¿‡å‡†ç¡®çš„æ ‡æ³¨ã€‚æ ‡æ³¨äººå‘˜æ ¹æ®æ¨±æ¡ƒçš„å¤–è§‚ç‰¹å¾ï¼Œç»“åˆå†œä¸šä¸“å®¶çš„æ„è§ï¼Œå¯¹æ¯ä¸€å¼ å›¾åƒè¿›è¡Œåˆ†ç±»ã€‚è¿™ç§ä¸¥è°¨çš„æ ‡æ³¨æµç¨‹ä¸ºåç»­çš„æ¨¡å‹è®­ç»ƒæä¾›äº†åšå®çš„åŸºç¡€ï¼Œç¡®ä¿äº†æ•°æ®é›†çš„é«˜è´¨é‡å’Œé«˜å¯é æ€§ã€‚

ä¸ºäº†è¿›ä¸€æ­¥æå‡æ¨¡å‹çš„æ€§èƒ½ï¼Œæ•°æ®é›†è¿˜åŒ…å«äº†ä¸€äº›æ•°æ®å¢å¼ºæŠ€æœ¯çš„åº”ç”¨ï¼Œä¾‹å¦‚éšæœºè£å‰ªã€æ—‹è½¬ã€é¢œè‰²å˜æ¢ç­‰ã€‚è¿™äº›æŠ€æœ¯çš„å¼•å…¥ä¸ä»…å¢åŠ äº†æ•°æ®é›†çš„å¤šæ ·æ€§ï¼Œè¿˜èƒ½æœ‰æ•ˆå‡å°‘æ¨¡å‹çš„è¿‡æ‹Ÿåˆç°è±¡ï¼Œä½¿å¾—æ¨¡å‹åœ¨é¢å¯¹æœªè§æ ·æœ¬æ—¶ä¾ç„¶èƒ½å¤Ÿä¿æŒè‰¯å¥½çš„è¯†åˆ«èƒ½åŠ›ã€‚æ­¤å¤–ï¼Œæ•°æ®é›†çš„è®¾è®¡ä¹Ÿè€ƒè™‘åˆ°äº†å®é™…åº”ç”¨ä¸­çš„å®æ—¶æ€§éœ€æ±‚ï¼Œé€šè¿‡ä¼˜åŒ–å›¾åƒçš„åˆ†è¾¨ç‡å’Œå¤„ç†é€Ÿåº¦ï¼Œç¡®ä¿æ¨¡å‹èƒ½å¤Ÿåœ¨ç°åœºç¯å¢ƒä¸­å¿«é€Ÿå“åº”ã€‚

åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œé‡‡ç”¨YOLOv8è¿™ä¸€å…ˆè¿›çš„ç›®æ ‡æ£€æµ‹ç®—æ³•ï¼Œç»“åˆâ€œCerejasâ€æ•°æ®é›†çš„ç‰¹æ€§ï¼Œèƒ½å¤Ÿå®ç°å¯¹æ¨±æ¡ƒæˆç†Ÿåº¦çš„é«˜æ•ˆæ£€æµ‹ã€‚YOLOv8ä»¥å…¶ä¼˜è¶Šçš„æ£€æµ‹é€Ÿåº¦å’Œå‡†ç¡®æ€§ï¼Œæˆä¸ºäº†æœ¬ç ”ç©¶çš„ç†æƒ³é€‰æ‹©ã€‚é€šè¿‡å¯¹æ•°æ®é›†çš„ä¸æ–­è¿­ä»£å’Œä¼˜åŒ–ï¼Œç ”ç©¶å›¢é˜Ÿå¸Œæœ›èƒ½å¤Ÿåœ¨æ¨±æ¡ƒæˆç†Ÿåº¦æ£€æµ‹é¢†åŸŸå–å¾—çªç ´æ€§è¿›å±•ï¼Œä¸ºå†œä¸šç”Ÿäº§æä¾›æ›´åŠ æ™ºèƒ½åŒ–çš„è§£å†³æ–¹æ¡ˆã€‚

æ€»ä¹‹ï¼Œâ€œCerejasâ€æ•°æ®é›†ä¸ä»…æ˜¯æœ¬ç ”ç©¶çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†ï¼Œæ›´æ˜¯æ¨åŠ¨æ¨±æ¡ƒæˆç†Ÿåº¦æ£€æµ‹æŠ€æœ¯å‘å±•çš„é‡è¦åŸºçŸ³ã€‚é€šè¿‡å¯¹è¯¥æ•°æ®é›†çš„æ·±å…¥åˆ†æå’Œåº”ç”¨ï¼Œç ”ç©¶å›¢é˜ŸæœŸæœ›èƒ½å¤Ÿä¸ºæ¨±æ¡ƒç§æ¤è€…æä¾›ç§‘å­¦ã€æœ‰æ•ˆçš„ç®¡ç†å·¥å…·ï¼ŒåŠ©åŠ›ç°ä»£å†œä¸šçš„å¯æŒç»­å‘å±•ã€‚éšç€æŠ€æœ¯çš„ä¸æ–­è¿›æ­¥å’Œæ•°æ®é›†çš„æŒç»­æ›´æ–°ï¼Œæ¨±æ¡ƒæˆç†Ÿåº¦æ£€æµ‹ç³»ç»Ÿçš„åº”ç”¨å‰æ™¯å°†æ›´åŠ å¹¿é˜”ï¼Œæœ€ç»ˆå®ç°æé«˜å†œä¸šç”Ÿäº§æ•ˆç‡å’Œå†œäº§å“è´¨é‡çš„ç›®æ ‡ã€‚

![4.png](4.png)

![5.png](5.png)

![6.png](6.png)

![7.png](7.png)

![8.png](8.png)

### 5.å…¨å¥—é¡¹ç›®ç¯å¢ƒéƒ¨ç½²è§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰

[5.1 ç¯å¢ƒéƒ¨ç½²æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404473917358506534?logTag=c807d0cbc21c0ef59de5)




[5.2 å®‰è£…Pythonè™šæ‹Ÿç¯å¢ƒåˆ›å»ºå’Œä¾èµ–åº“å®‰è£…è§†é¢‘æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404474678003106304?logTag=1f1041108cd1f708b01a)

### 6.æ‰‹æŠŠæ‰‹YOLOV8è®­ç»ƒè§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€å°ç™½æœ‰æ‰‹å°±èƒ½å­¦ä¼šï¼‰

[6.1 æ‰‹æŠŠæ‰‹YOLOV8è®­ç»ƒè§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€å°ç™½æœ‰æ‰‹å°±èƒ½å­¦ä¼šï¼‰](https://www.ixigua.com/7404477157818401292?logTag=d31a2dfd1983c9668658)

### 7.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹ä»£ç åŠ è½½è°ƒå‚è§†é¢‘æ•™ç¨‹ï¼ˆä¸€é”®åŠ è½½å†™å¥½çš„æ”¹è¿›æ¨¡å‹çš„é…ç½®æ–‡ä»¶ï¼‰

[7.1 70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹ä»£ç åŠ è½½è°ƒå‚è§†é¢‘æ•™ç¨‹ï¼ˆä¸€é”®åŠ è½½å†™å¥½çš„æ”¹è¿›æ¨¡å‹çš„é…ç½®æ–‡ä»¶ï¼‰](https://www.ixigua.com/7404478314661806627?logTag=29066f8288e3f4eea3a4)

### 8.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŸç†è®²è§£ï¼ˆéç§‘ç­ä¹Ÿå¯ä»¥è½»æ¾å†™åˆŠå‘åˆŠï¼ŒV10ç‰ˆæœ¬æ­£åœ¨ç§‘ç ”å¾…æ›´æ–°ï¼‰

ç”±äºç¯‡å¹…é™åˆ¶ï¼Œæ¯ä¸ªåˆ›æ–°ç‚¹çš„å…·ä½“åŸç†è®²è§£å°±ä¸ä¸€ä¸€å±•å¼€ï¼Œå…·ä½“è§ä¸‹åˆ—ç½‘å€ä¸­çš„åˆ›æ–°ç‚¹å¯¹åº”å­é¡¹ç›®çš„æŠ€æœ¯åŸç†åšå®¢ç½‘å€ã€Blogã€‘ï¼š

![9.png](9.png)

[8.1 70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŸç†è®²è§£é“¾æ¥](https://gitee.com/qunmasj/good)

### 9.ç³»ç»ŸåŠŸèƒ½å±•ç¤ºï¼ˆæ£€æµ‹å¯¹è±¡ä¸ºä¸¾ä¾‹ï¼Œå®é™…å†…å®¹ä»¥æœ¬é¡¹ç›®æ•°æ®é›†ä¸ºå‡†ï¼‰

å›¾9.1.ç³»ç»Ÿæ”¯æŒæ£€æµ‹ç»“æœè¡¨æ ¼æ˜¾ç¤º

  å›¾9.2.ç³»ç»Ÿæ”¯æŒç½®ä¿¡åº¦å’ŒIOUé˜ˆå€¼æ‰‹åŠ¨è°ƒèŠ‚

  å›¾9.3.ç³»ç»Ÿæ”¯æŒè‡ªå®šä¹‰åŠ è½½æƒé‡æ–‡ä»¶best.pt(éœ€è¦ä½ é€šè¿‡æ­¥éª¤5ä¸­è®­ç»ƒè·å¾—)

  å›¾9.4.ç³»ç»Ÿæ”¯æŒæ‘„åƒå¤´å®æ—¶è¯†åˆ«

  å›¾9.5.ç³»ç»Ÿæ”¯æŒå›¾ç‰‡è¯†åˆ«

  å›¾9.6.ç³»ç»Ÿæ”¯æŒè§†é¢‘è¯†åˆ«

  å›¾9.7.ç³»ç»Ÿæ”¯æŒè¯†åˆ«ç»“æœæ–‡ä»¶è‡ªåŠ¨ä¿å­˜

  å›¾9.8.ç³»ç»Ÿæ”¯æŒExcelå¯¼å‡ºæ£€æµ‹ç»“æœæ•°æ®

![10.png](10.png)

![11.png](11.png)

![12.png](12.png)

![13.png](13.png)

![14.png](14.png)

![15.png](15.png)

![16.png](16.png)

![17.png](17.png)

### 10.åŸå§‹YOLOV8ç®—æ³•åŸç†

åŸå§‹YOLOv8ç®—æ³•åŸç†

YOLOv8ä½œä¸ºYOLOç³»åˆ—çš„æœ€æ–°ç‰ˆæœ¬ï¼Œä»£è¡¨äº†ç›®æ ‡æ£€æµ‹é¢†åŸŸçš„ä¸€æ¬¡é‡è¦è¿›æ­¥ã€‚å…¶è®¾è®¡ç†å¿µä¸ä»…ç»§æ‰¿äº†å‰å‡ ä»£æ¨¡å‹çš„ä¼˜ç‚¹ï¼Œè¿˜é€šè¿‡å¼•å…¥æ–°æŠ€æœ¯å’Œä¼˜åŒ–ç­–ç•¥ï¼Œè¿›ä¸€æ­¥æå‡äº†æ¨¡å‹çš„æ€§èƒ½å’Œçµæ´»æ€§ã€‚YOLOv8çš„æ¶æ„ä¸»è¦ç”±è¾“å…¥å±‚ã€ä¸»å¹²ç½‘ç»œã€é¢ˆéƒ¨ç½‘ç»œå’Œå¤´éƒ¨ç½‘ç»œç»„æˆï¼Œå½¢æˆäº†ä¸€ä¸ªé«˜æ•ˆçš„ç›®æ ‡æ£€æµ‹ç³»ç»Ÿã€‚

åœ¨è¾“å…¥å±‚ï¼ŒYOLOv8é¦–å…ˆå¯¹è¾“å…¥å›¾åƒè¿›è¡Œç¼©æ”¾ï¼Œä»¥æ»¡è¶³æ¨¡å‹å¯¹å›¾åƒå°ºå¯¸çš„è¦æ±‚ã€‚è¿™ä¸€è¿‡ç¨‹ç¡®ä¿äº†æ¨¡å‹èƒ½å¤Ÿå¤„ç†ä¸åŒå°ºå¯¸çš„å›¾åƒï¼Œä»è€Œå¢å¼ºäº†å…¶é€‚ç”¨æ€§ã€‚æ¥ä¸‹æ¥ï¼Œä¸»å¹²ç½‘ç»œé€šè¿‡ä¸€ç³»åˆ—å·ç§¯æ“ä½œå¯¹å›¾åƒè¿›è¡Œä¸‹é‡‡æ ·ï¼Œæå–å‡ºä¸°å¯Œçš„ç‰¹å¾ä¿¡æ¯ã€‚YOLOv8é‡‡ç”¨äº†CSPDarknetä½œä¸ºä¸»å¹²ç½‘ç»œï¼Œè¿™ä¸€ç»“æ„é€šè¿‡å°†ç½‘ç»œåˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†åŒ…å«å¤šä¸ªæ®‹å·®å—ï¼Œæ˜¾è‘—æé«˜äº†ç‰¹å¾æå–çš„æ•ˆç‡å’Œå‡†ç¡®æ€§ã€‚ä¸å‰ä»£æ¨¡å‹YOLOv5ç›¸æ¯”ï¼ŒYOLOv8å¼•å…¥äº†C2fæ¨¡å—æ›¿ä»£äº†C3æ¨¡å—ã€‚C2fæ¨¡å—çš„è®¾è®¡ä½¿å¾—è¾“å…¥ç‰¹å¾å›¾è¢«åˆ†ä¸ºä¸¤ä¸ªåˆ†æ”¯ï¼Œç»è¿‡å„è‡ªçš„å·ç§¯å±‚è¿›è¡Œé™ç»´å¤„ç†ï¼Œæœ€ç»ˆé€šè¿‡ä¸€ä¸ªå·ç§¯å±‚è¿›è¡Œç‰¹å¾èåˆã€‚è¿™ç§åˆ†æ”¯ç»“æ„ä¸ä»…å¢åŠ äº†ç‰¹å¾å›¾çš„ç»´åº¦ï¼Œè¿˜é€šè¿‡å¢å¼ºçš„æ¢¯åº¦æµä¿¡æ¯æå‡äº†æ¨¡å‹çš„å­¦ä¹ èƒ½åŠ›ã€‚

YOLOv8åœ¨ç‰¹å¾æå–è¿‡ç¨‹ä¸­è¿˜å¼•å…¥äº†å¿«é€Ÿç©ºé—´é‡‘å­—å¡”æ± åŒ–ï¼ˆSPPFï¼‰ç»“æ„ã€‚è¿™ä¸€åˆ›æ–°ä½¿å¾—æ¨¡å‹èƒ½å¤Ÿæœ‰æ•ˆæå–ä¸åŒå°ºåº¦çš„ç‰¹å¾ï¼ŒåŒæ—¶æ˜¾è‘—å‡å°‘äº†å‚æ•°é‡å’Œè®¡ç®—é‡ã€‚SPPFé€šè¿‡ä¸‰ä¸ªæœ€å¤§æ± åŒ–å±‚çš„ç»„åˆï¼Œå¢å¼ºäº†ç½‘ç»œå¯¹å¤šå°ºåº¦ç‰¹å¾çš„æŠ½è±¡èƒ½åŠ›ï¼Œç¡®ä¿äº†æ¨¡å‹åœ¨é¢å¯¹å¤æ‚åœºæ™¯æ—¶çš„é²æ£’æ€§ã€‚

åœ¨é¢ˆéƒ¨ç½‘ç»œéƒ¨åˆ†ï¼ŒYOLOv8é‡‡ç”¨äº†ç‰¹å¾é‡‘å­—å¡”ç½‘ç»œï¼ˆFPNï¼‰å’Œè·¯å¾„èšåˆç½‘ç»œï¼ˆPANï¼‰çš„ç»“åˆç»“æ„ã€‚è¿™ä¸€è®¾è®¡é€šè¿‡å¤šä¸ªå·ç§¯å±‚å’Œæ± åŒ–å±‚çš„ç»„åˆï¼Œè¿›ä¸€æ­¥å¤„ç†å’Œå‹ç¼©ç‰¹å¾å›¾ã€‚FPNç»“æ„çš„å¼•å…¥ä½¿å¾—æ¨¡å‹èƒ½å¤Ÿæœ‰æ•ˆèåˆæ¥è‡ªä¸åŒå°ºåº¦çš„ç‰¹å¾ä¿¡æ¯ï¼Œè€ŒPANåˆ™é€šè¿‡è·¯å¾„èšåˆçš„æ–¹å¼å¢å¼ºäº†ç‰¹å¾çš„ä¼ é€’æ•ˆç‡ã€‚è¿™ç§å¤šå±‚æ¬¡çš„ç‰¹å¾èåˆç­–ç•¥ï¼Œä½¿å¾—YOLOv8åœ¨ç›®æ ‡æ£€æµ‹æ—¶èƒ½å¤Ÿå……åˆ†åˆ©ç”¨ä¸åŒå±‚æ¬¡çš„ç‰¹å¾ï¼Œä»è€Œæé«˜äº†æ£€æµ‹çš„å‡†ç¡®æ€§ã€‚

åœ¨ç›®æ ‡æ£€æµ‹çš„å®ç°ä¸Šï¼ŒYOLOv8é‡‡ç”¨äº†ä¸€ç§åŸºäºæ— é”šæ¡†ï¼ˆAnchor-Freeï¼‰çš„æ£€æµ‹æ–¹å¼ã€‚è¿™ä¸€åˆ›æ–°ä½¿å¾—æ¨¡å‹èƒ½å¤Ÿç›´æ¥é¢„æµ‹ç›®æ ‡çš„ä¸­å¿ƒç‚¹åŠå…¶å®½é«˜æ¯”ä¾‹ï¼Œé¿å…äº†ä¼ ç»ŸAnchoræ¡†æ–¹æ³•æ‰€å¸¦æ¥çš„å¤æ‚æ€§å’Œå±€é™æ€§ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒYOLOv8ä¸ä»…å‡å°‘äº†Anchoræ¡†çš„æ•°é‡ï¼Œè¿˜æé«˜äº†æ£€æµ‹é€Ÿåº¦å’Œå‡†ç¡®åº¦ã€‚è¿™ç§ç›´æ¥é¢„æµ‹çš„æ–¹å¼ä½¿å¾—æ¨¡å‹åœ¨å¤„ç†å¤æ‚åœºæ™¯æ—¶ï¼Œèƒ½å¤Ÿæ›´å¿«é€Ÿåœ°åšå‡ºååº”ï¼Œä»è€Œæ»¡è¶³å®æ—¶æ£€æµ‹çš„éœ€æ±‚ã€‚

YOLOv8çš„å¤´éƒ¨ç½‘ç»œé‡‡ç”¨äº†è§£è€¦çš„æ£€æµ‹å¤´ï¼Œé€šè¿‡ä¸¤ä¸ªå¹¶è¡Œçš„å·ç§¯åˆ†æ”¯åˆ†åˆ«è®¡ç®—å›å½’å’Œç±»åˆ«çš„æŸå¤±ã€‚è¿™ä¸€è®¾è®¡ä½¿å¾—æ¨¡å‹åœ¨è¿›è¡Œç›®æ ‡æ£€æµ‹æ—¶ï¼Œèƒ½å¤Ÿæ›´åŠ æ¸…æ™°åœ°åˆ†ç¦»ç›®æ ‡çš„å®šä½å’Œåˆ†ç±»ä»»åŠ¡ï¼Œä»è€Œæé«˜äº†æ•´ä½“çš„æ£€æµ‹æ€§èƒ½ã€‚é€šè¿‡è¿™æ ·çš„ç»“æ„ï¼ŒYOLOv8èƒ½å¤Ÿåœ¨ä¿è¯é«˜ç²¾åº¦çš„åŒæ—¶ï¼Œä¿æŒè¾ƒå¿«çš„æ£€æµ‹é€Ÿåº¦ï¼Œä¸ºå®é™…åº”ç”¨æä¾›äº†å¼ºæœ‰åŠ›çš„æ”¯æŒã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒYOLOv8çš„åŸå§‹ç®—æ³•åŸç†é€šè¿‡é«˜æ•ˆçš„ç‰¹å¾æå–ã€çµæ´»çš„ç‰¹å¾èåˆå’Œåˆ›æ–°çš„ç›®æ ‡æ£€æµ‹ç­–ç•¥ï¼Œæ„å»ºäº†ä¸€ä¸ªåœ¨å‡†ç¡®æ€§å’Œé€Ÿåº¦ä¸Šéƒ½è¡¨ç°ä¼˜å¼‚çš„ç›®æ ‡æ£€æµ‹æ¨¡å‹ã€‚å…¶è®¾è®¡ä¸ä»…å¸æ”¶äº†å‰ä»£æ¨¡å‹çš„ç²¾åï¼Œè¿˜é€šè¿‡å¼•å…¥æ–°çš„æŠ€æœ¯å’Œæ–¹æ³•ï¼Œæ¨åŠ¨äº†ç›®æ ‡æ£€æµ‹é¢†åŸŸçš„å‘å±•ã€‚éšç€YOLOv8çš„å‘å¸ƒï¼Œç›®æ ‡æ£€æµ‹çš„åº”ç”¨åœºæ™¯å°†æ›´åŠ å¹¿æ³›ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦å®æ—¶å“åº”çš„ä»»åŠ¡ä¸­ï¼Œå¦‚è‡ªåŠ¨é©¾é©¶ã€å®‰é˜²ç›‘æ§å’Œå·¥ä¸šè‡ªåŠ¨åŒ–ç­‰é¢†åŸŸï¼ŒYOLOv8æ— ç–‘å°†å‘æŒ¥é‡è¦ä½œç”¨ã€‚

![18.png](18.png)

### 11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰

#### 11.1 70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\utils\callbacks\tensorboard.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç²¾ç®€å’Œæ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼Œä¸»è¦åŠŸèƒ½æ˜¯ä½¿ç”¨ TensorBoard è®°å½•è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ ‡é‡å’Œæ¨¡å‹å›¾ã€‚

```python
# å¯¼å…¥å¿…è¦çš„åº“
from ultralytics.utils import LOGGER, SETTINGS, TESTS_RUNNING, colorstr

try:
    # å°è¯•å¯¼å…¥ TensorBoard çš„ SummaryWriter
    from torch.utils.tensorboard import SummaryWriter

    # ç¡®ä¿å½“å‰ä¸æ˜¯æµ‹è¯•è¿è¡Œ
    assert not TESTS_RUNNING  
    # ç¡®ä¿ TensorBoard é›†æˆå·²å¯ç”¨
    assert SETTINGS['tensorboard'] is True  
    WRITER = None  # åˆå§‹åŒ– TensorBoard SummaryWriter å®ä¾‹

except (ImportError, AssertionError, TypeError):
    # å¤„ç†å¯¼å…¥é”™è¯¯æˆ–æ–­è¨€é”™è¯¯
    SummaryWriter = None  # å¦‚æœå¯¼å…¥å¤±è´¥ï¼ŒSummaryWriter è®¾ç½®ä¸º None


def _log_scalars(scalars, step=0):
    """å°†æ ‡é‡å€¼è®°å½•åˆ° TensorBoardã€‚"""
    if WRITER:  # å¦‚æœ WRITER å­˜åœ¨
        for k, v in scalars.items():  # éå†æ ‡é‡å­—å…¸
            WRITER.add_scalar(k, v, step)  # è®°å½•æ ‡é‡


def _log_tensorboard_graph(trainer):
    """å°†æ¨¡å‹å›¾è®°å½•åˆ° TensorBoardã€‚"""
    try:
        import warnings
        from ultralytics.utils.torch_utils import de_parallel, torch

        imgsz = trainer.args.imgsz  # è·å–è¾“å…¥å›¾åƒå¤§å°
        imgsz = (imgsz, imgsz) if isinstance(imgsz, int) else imgsz  # ç¡®ä¿ä¸ºå…ƒç»„æ ¼å¼
        p = next(trainer.model.parameters())  # è·å–æ¨¡å‹å‚æ•°ä»¥ç¡®å®šè®¾å¤‡å’Œç±»å‹
        im = torch.zeros((1, 3, *imgsz), device=p.device, dtype=p.dtype)  # åˆ›å»ºè¾“å…¥å›¾åƒï¼ˆå¿…é¡»ä¸ºé›¶ï¼‰

        with warnings.catch_warnings():
            warnings.simplefilter('ignore', category=UserWarning)  # å¿½ç•¥ JIT è·Ÿè¸ªè­¦å‘Š
            WRITER.add_graph(torch.jit.trace(de_parallel(trainer.model), im, strict=False), [])  # è®°å½•æ¨¡å‹å›¾
    except Exception as e:
        LOGGER.warning(f'WARNING âš ï¸ TensorBoard graph visualization failure {e}')  # è®°å½•è­¦å‘Š


def on_pretrain_routine_start(trainer):
    """åˆå§‹åŒ– TensorBoard è®°å½•ã€‚"""
    if SummaryWriter:  # å¦‚æœ SummaryWriter å­˜åœ¨
        try:
            global WRITER
            WRITER = SummaryWriter(str(trainer.save_dir))  # åˆ›å»º SummaryWriter å®ä¾‹
            prefix = colorstr('TensorBoard: ')
            LOGGER.info(f"{prefix}Start with 'tensorboard --logdir {trainer.save_dir}', view at http://localhost:6006/")  # æç¤ºç”¨æˆ·å¯åŠ¨ TensorBoard
        except Exception as e:
            LOGGER.warning(f'WARNING âš ï¸ TensorBoard not initialized correctly, not logging this run. {e}')  # è®°å½•åˆå§‹åŒ–é”™è¯¯


def on_train_start(trainer):
    """è®°å½• TensorBoard å›¾ã€‚"""
    if WRITER:  # å¦‚æœ WRITER å­˜åœ¨
        _log_tensorboard_graph(trainer)  # è®°å½•æ¨¡å‹å›¾


def on_batch_end(trainer):
    """åœ¨è®­ç»ƒæ‰¹æ¬¡ç»“æŸæ—¶è®°å½•æ ‡é‡ç»Ÿè®¡ä¿¡æ¯ã€‚"""
    _log_scalars(trainer.label_loss_items(trainer.tloss, prefix='train'), trainer.epoch + 1)  # è®°å½•è®­ç»ƒæŸå¤±


def on_fit_epoch_end(trainer):
    """åœ¨è®­ç»ƒå‘¨æœŸç»“æŸæ—¶è®°å½•å‘¨æœŸæŒ‡æ ‡ã€‚"""
    _log_scalars(trainer.metrics, trainer.epoch + 1)  # è®°å½•è®­ç»ƒæŒ‡æ ‡


# å®šä¹‰å›è°ƒå‡½æ•°å­—å…¸ï¼Œåªæœ‰åœ¨ SummaryWriter å­˜åœ¨æ—¶æ‰ä¼šè¢«å¡«å……
callbacks = {
    'on_pretrain_routine_start': on_pretrain_routine_start,
    'on_train_start': on_train_start,
    'on_fit_epoch_end': on_fit_epoch_end,
    'on_batch_end': on_batch_end
} if SummaryWriter else {}
```

### ä»£ç è¯´æ˜ï¼š
1. **å¯¼å…¥æ¨¡å—**ï¼šå¯¼å…¥å¿…è¦çš„æ¨¡å—å’Œå·¥å…·ï¼Œç¡®ä¿ TensorBoard çš„ä½¿ç”¨ã€‚
2. **å¼‚å¸¸å¤„ç†**ï¼šåœ¨å¯¼å…¥ `SummaryWriter` æ—¶å¤„ç†å¯èƒ½çš„é”™è¯¯ï¼Œä»¥é˜²æ­¢ç¨‹åºå´©æºƒã€‚
3. **æ—¥å¿—è®°å½•å‡½æ•°**ï¼š
   - `_log_scalars`ï¼šå°†æ ‡é‡æ•°æ®è®°å½•åˆ° TensorBoardã€‚
   - `_log_tensorboard_graph`ï¼šè®°å½•æ¨¡å‹çš„è®¡ç®—å›¾ã€‚
4. **å›è°ƒå‡½æ•°**ï¼šåœ¨è®­ç»ƒçš„ä¸åŒé˜¶æ®µè°ƒç”¨ç›¸åº”çš„å›è°ƒå‡½æ•°ä»¥è®°å½•æ•°æ®ã€‚
5. **å›è°ƒå­—å…¸**ï¼šæ ¹æ® `SummaryWriter` çš„å­˜åœ¨ä¸å¦ï¼ŒåŠ¨æ€åˆ›å»ºå›è°ƒå‡½æ•°å­—å…¸ã€‚ 

æ­¤ä»£ç ä¸»è¦ç”¨äºåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ç›‘æ§æ¨¡å‹çš„æ€§èƒ½ï¼Œä¾¿äºåç»­åˆ†æå’Œè°ƒè¯•ã€‚

è¿™ä¸ªæ–‡ä»¶æ˜¯ä¸€ä¸ªç”¨äºYOLOï¼ˆYou Only Look Onceï¼‰ç®—æ³•çš„TensorBoardå›è°ƒæ¨¡å—ï¼Œä¸»è¦ç”¨äºåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­è®°å½•å’Œå¯è§†åŒ–æ¨¡å‹çš„è®­ç»ƒçŠ¶æ€å’Œæ€§èƒ½æŒ‡æ ‡ã€‚æ–‡ä»¶ä¸­é¦–å…ˆå¯¼å…¥äº†ä¸€äº›å¿…è¦çš„åº“å’Œæ¨¡å—ï¼ŒåŒ…æ‹¬Ultralyticsåº“ä¸­çš„æ—¥å¿—è®°å½•å™¨å’Œè®¾ç½®ï¼Œä»¥åŠPyTorchçš„TensorBoardå·¥å…·ã€‚

åœ¨å°è¯•å¯¼å…¥`SummaryWriter`æ—¶ï¼Œä»£ç ä¸­åŒ…å«äº†ä¸€äº›å¼‚å¸¸å¤„ç†é€»è¾‘ã€‚è¿™æ˜¯å› ä¸ºåœ¨æŸäº›æƒ…å†µä¸‹ï¼ˆä¾‹å¦‚åœ¨Windowsä¸Šï¼‰ï¼Œå¯èƒ½ä¼šé‡åˆ°ä¸protobufç›¸å…³çš„é”™è¯¯ã€‚è‹¥å¯¼å…¥å¤±è´¥æˆ–è®¾ç½®ä¸æ­£ç¡®ï¼Œ`SummaryWriter`å°†è¢«è®¾ç½®ä¸º`None`ï¼Œè¿™æ„å‘³ç€TensorBoardåŠŸèƒ½å°†æ— æ³•ä½¿ç”¨ã€‚

æ–‡ä»¶ä¸­å®šä¹‰äº†å‡ ä¸ªä¸»è¦çš„å‡½æ•°ã€‚`_log_scalars`å‡½æ•°ç”¨äºå°†æ ‡é‡å€¼è®°å½•åˆ°TensorBoardä¸­ï¼Œæ¥å—ä¸€ä¸ªå­—å…¸ç±»å‹çš„å‚æ•°`scalars`ï¼Œå¹¶åœ¨æ¯ä¸ªè®­ç»ƒæ­¥éª¤ä¸­è®°å½•è¿™äº›å€¼ã€‚`_log_tensorboard_graph`å‡½æ•°åˆ™ç”¨äºå°†æ¨¡å‹çš„è®¡ç®—å›¾è®°å½•åˆ°TensorBoardä¸­ï¼Œå®ƒé¦–å…ˆåˆ›å»ºä¸€ä¸ªè¾“å…¥å¼ é‡ï¼ˆå…¨é›¶ï¼‰ï¼Œç„¶åä½¿ç”¨Torchçš„JITç¼–è¯‘å™¨è¿›è¡Œè·Ÿè¸ªï¼Œå¹¶å°†ç”Ÿæˆçš„å›¾æ·»åŠ åˆ°TensorBoardä¸­ã€‚å¦‚æœåœ¨è®°å½•è¿‡ç¨‹ä¸­å‘ç”Ÿå¼‚å¸¸ï¼Œä¼šé€šè¿‡æ—¥å¿—è®°å½•è­¦å‘Šä¿¡æ¯ã€‚

æ¥ä¸‹æ¥ï¼Œå®šä¹‰äº†ä¸€äº›å›è°ƒå‡½æ•°ï¼Œåˆ†åˆ«åœ¨ä¸åŒçš„è®­ç»ƒé˜¶æ®µè¢«è°ƒç”¨ã€‚`on_pretrain_routine_start`å‡½æ•°åœ¨è®­ç»ƒå¼€å§‹å‰åˆå§‹åŒ–TensorBoardçš„è®°å½•å™¨ï¼Œå¹¶æä¾›äº†å¦‚ä½•å¯åŠ¨TensorBoardçš„æç¤ºä¿¡æ¯ã€‚`on_train_start`å‡½æ•°åœ¨è®­ç»ƒå¼€å§‹æ—¶è°ƒç”¨ï¼Œç”¨äºè®°å½•æ¨¡å‹çš„è®¡ç®—å›¾ã€‚`on_batch_end`å‡½æ•°åœ¨æ¯ä¸ªè®­ç»ƒæ‰¹æ¬¡ç»“æŸæ—¶è°ƒç”¨ï¼Œè®°å½•å½“å‰æ‰¹æ¬¡çš„æŸå¤±ç»Ÿè®¡ä¿¡æ¯ã€‚`on_fit_epoch_end`å‡½æ•°åœ¨æ¯ä¸ªè®­ç»ƒå‘¨æœŸç»“æŸæ—¶è°ƒç”¨ï¼Œè®°å½•è¯¥å‘¨æœŸçš„æ€§èƒ½æŒ‡æ ‡ã€‚

æœ€åï¼Œæ‰€æœ‰çš„å›è°ƒå‡½æ•°è¢«ç»„ç»‡æˆä¸€ä¸ªå­—å…¸ï¼Œåªæœ‰åœ¨`SummaryWriter`å¯ç”¨çš„æƒ…å†µä¸‹æ‰ä¼šè¢«å®šä¹‰ã€‚è¿™ä½¿å¾—åœ¨æ²¡æœ‰TensorBoardæ”¯æŒçš„ç¯å¢ƒä¸­ï¼Œç¨‹åºèƒ½å¤Ÿä¼˜é›…åœ°å¤„ç†å¹¶é¿å…é”™è¯¯ã€‚æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªæ–‡ä»¶ä¸ºYOLOæ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹æä¾›äº†å¼ºå¤§çš„å¯è§†åŒ–æ”¯æŒï¼Œå¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°ç†è§£å’Œä¼˜åŒ–æ¨¡å‹çš„æ€§èƒ½ã€‚

#### 11.2 70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\__init__.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
# Ultralytics YOLO ğŸš€, AGPL-3.0 license

# å®šä¹‰å½“å‰ç‰ˆæœ¬
__version__ = '8.0.202'

# ä»ultralytics.modelsæ¨¡å—ä¸­å¯¼å…¥YOLOã€RTDETRã€SAMç­‰æ¨¡å‹
from ultralytics.models import RTDETR, SAM, YOLO
from ultralytics.models.fastsam import FastSAM  # å¯¼å…¥FastSAMæ¨¡å‹
from ultralytics.models.nas import NAS  # å¯¼å…¥NASæ¨¡å‹

# å¯¼å…¥è®¾ç½®å’Œæ£€æŸ¥å·¥å…·
from ultralytics.utils import SETTINGS as settings  # å¯¼å…¥è®¾ç½®
from ultralytics.utils.checks import check_yolo as checks  # å¯¼å…¥YOLOæ£€æŸ¥å·¥å…·
from ultralytics.utils.downloads import download  # å¯¼å…¥ä¸‹è½½å·¥å…·

# å®šä¹‰æ¨¡å—çš„å…¬å¼€æ¥å£ï¼Œæ–¹ä¾¿å¤–éƒ¨è®¿é—®
__all__ = '__version__', 'YOLO', 'NAS', 'SAM', 'FastSAM', 'RTDETR', 'checks', 'download', 'settings'
```

### æ³¨é‡Šè¯´æ˜ï¼š
1. **ç‰ˆæœ¬å®šä¹‰**ï¼š`__version__` å˜é‡ç”¨äºæ ‡è¯†å½“å‰æ¨¡å—çš„ç‰ˆæœ¬å·ã€‚
2. **æ¨¡å‹å¯¼å…¥**ï¼šä» `ultralytics.models` æ¨¡å—ä¸­å¯¼å…¥äº†å¤šä¸ªæ¨¡å‹ï¼ŒåŒ…æ‹¬ YOLOã€RTDETRã€SAM å’Œ FastSAMã€‚è¿™äº›æ¨¡å‹æ˜¯è¿›è¡Œç›®æ ‡æ£€æµ‹å’Œåˆ†å‰²çš„æ ¸å¿ƒç»„ä»¶ã€‚
3. **å·¥å…·å¯¼å…¥**ï¼š
   - `SETTINGS` ç”¨äºé…ç½®å’Œè®¾ç½®ç›¸å…³å‚æ•°ã€‚
   - `check_yolo` æ˜¯ä¸€ä¸ªæ£€æŸ¥å·¥å…·ï¼Œç”¨äºéªŒè¯ YOLO æ¨¡å‹çš„æ­£ç¡®æ€§å’Œæœ‰æ•ˆæ€§ã€‚
   - `download` å‡½æ•°ç”¨äºä¸‹è½½å¿…è¦çš„èµ„æºæˆ–æ¨¡å‹æ–‡ä»¶ã€‚
4. **å…¬å¼€æ¥å£**ï¼š`__all__` å˜é‡å®šä¹‰äº†æ¨¡å—çš„å…¬å…±æ¥å£ï¼Œåªæœ‰åœ¨è¿™ä¸ªåˆ—è¡¨ä¸­çš„åç§°æ‰èƒ½è¢« `from module import *` è¯­å¥å¯¼å…¥ï¼Œç¡®ä¿æ¨¡å—çš„å°è£…æ€§ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶æ˜¯Ultralytics YOLOï¼ˆYou Only Look Onceï¼‰ç³»åˆ—ç®—æ³•çš„ä¸€ä¸ªåˆå§‹åŒ–æ¨¡å—ï¼Œä¸»è¦ç”¨äºå¯¼å…¥å’Œç»„ç»‡ä¸YOLOv8ç›¸å…³çš„åŠŸèƒ½å’Œæ¨¡å‹ã€‚æ–‡ä»¶å¼€å¤´çš„æ³¨é‡Šè¡¨æ˜è¯¥é¡¹ç›®éµå¾ªAGPL-3.0è®¸å¯è¯ï¼Œå¹¶ä¸”æ ‡æ˜äº†å½“å‰ç‰ˆæœ¬ä¸º'8.0.202'ã€‚

æ¥ä¸‹æ¥ï¼Œæ–‡ä»¶é€šè¿‡`from`è¯­å¥å¯¼å…¥äº†å¤šä¸ªæ¨¡å‹å’Œå·¥å…·ã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒå¯¼å…¥äº†YOLOã€RTDETRã€SAMå’ŒFastSAMç­‰æ¨¡å‹ï¼Œè¿™äº›éƒ½æ˜¯YOLOv8ç®—æ³•çš„ä¸åŒå®ç°æˆ–å˜ç§ï¼Œé€‚ç”¨äºä¸åŒçš„ç›®æ ‡æ£€æµ‹ä»»åŠ¡ã€‚æ­¤å¤–ï¼Œè¿˜å¯¼å…¥äº†NASï¼ˆç¥ç»æ¶æ„æœç´¢ï¼‰æ¨¡å‹ï¼Œå¯èƒ½ç”¨äºä¼˜åŒ–æ¨¡å‹ç»“æ„ã€‚

åœ¨å·¥å…·æ–¹é¢ï¼Œæ–‡ä»¶å¯¼å…¥äº†`SETTINGS`ï¼Œè¿™æ˜¯ä¸€ä¸ªé…ç½®æˆ–è®¾ç½®æ¨¡å—ï¼Œå¯èƒ½åŒ…å«ä¸æ¨¡å‹è®­ç»ƒå’Œæ¨ç†ç›¸å…³çš„å‚æ•°ã€‚`check_yolo`æ˜¯ä¸€ä¸ªæ£€æŸ¥å·¥å…·ï¼Œç”¨äºéªŒè¯YOLOæ¨¡å‹çš„æœ‰æ•ˆæ€§æˆ–å…¼å®¹æ€§ã€‚`download`å‡½æ•°åˆ™å¯èƒ½ç”¨äºä¸‹è½½æ‰€éœ€çš„æ¨¡å‹æƒé‡æˆ–æ•°æ®é›†ã€‚

æœ€åï¼Œ`__all__`å˜é‡å®šä¹‰äº†æ¨¡å—çš„å…¬å…±æ¥å£ï¼ŒæŒ‡å®šäº†åœ¨ä½¿ç”¨`from module import *`æ—¶å¯ä»¥å¯¼å…¥çš„åç§°ã€‚è¿™æœ‰åŠ©äºæ¸…æ™°åœ°ç»„ç»‡æ¨¡å—å†…å®¹ï¼Œå¹¶ç¡®ä¿ç”¨æˆ·åªè®¿é—®åˆ°æ¨¡å—ä¸­å…¬å¼€çš„éƒ¨åˆ†ã€‚

æ€»ä½“æ¥è¯´ï¼Œè¿™ä¸ªæ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½æ˜¯ä½œä¸ºYOLOv8ç®—æ³•çš„å…¥å£ï¼Œæ•´åˆå’Œç®¡ç†ä¸åŒçš„æ¨¡å‹å’Œå·¥å…·ï¼Œæ–¹ä¾¿åç»­çš„ä½¿ç”¨å’Œæ‰©å±•ã€‚

#### 11.3 ui.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç®€åŒ–å¹¶æ·»åŠ è¯¦ç»†ä¸­æ–‡æ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼š

```python
import sys
import subprocess

def run_script(script_path):
    """
    ä½¿ç”¨å½“å‰ Python ç¯å¢ƒè¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚

    Args:
        script_path (str): è¦è¿è¡Œçš„è„šæœ¬è·¯å¾„

    Returns:
        None
    """
    # è·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„
    python_path = sys.executable

    # æ„å»ºè¿è¡Œå‘½ä»¤ï¼Œä½¿ç”¨ streamlit è¿è¡ŒæŒ‡å®šçš„è„šæœ¬
    command = f'"{python_path}" -m streamlit run "{script_path}"'

    # æ‰§è¡Œå‘½ä»¤å¹¶ç­‰å¾…å…¶å®Œæˆ
    result = subprocess.run(command, shell=True)
    
    # æ£€æŸ¥å‘½ä»¤æ‰§è¡Œçš„è¿”å›ç ï¼Œéé›¶è¡¨ç¤ºå‡ºé”™
    if result.returncode != 0:
        print("è„šæœ¬è¿è¡Œå‡ºé”™ã€‚")

# ä¸»ç¨‹åºå…¥å£
if __name__ == "__main__":
    # æŒ‡å®šè¦è¿è¡Œçš„è„šæœ¬è·¯å¾„
    script_path = "web.py"  # å‡è®¾è„šæœ¬åœ¨å½“å‰ç›®å½•ä¸‹

    # è°ƒç”¨å‡½æ•°è¿è¡Œè„šæœ¬
    run_script(script_path)
```

### ä»£ç è¯´æ˜ï¼š
1. **å¯¼å…¥æ¨¡å—**ï¼š
   - `sys`ï¼šç”¨äºè·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ã€‚
   - `subprocess`ï¼šç”¨äºæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚

2. **`run_script` å‡½æ•°**ï¼š
   - æ¥å—ä¸€ä¸ªå‚æ•° `script_path`ï¼Œè¡¨ç¤ºè¦è¿è¡Œçš„ Python è„šæœ¬çš„è·¯å¾„ã€‚
   - ä½¿ç”¨ `sys.executable` è·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ã€‚
   - æ„å»ºä¸€ä¸ªå‘½ä»¤å­—ç¬¦ä¸²ï¼Œä½¿ç”¨ `streamlit` æ¨¡å—è¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚
   - ä½¿ç”¨ `subprocess.run` æ‰§è¡Œæ„å»ºçš„å‘½ä»¤ï¼Œå¹¶ç­‰å¾…å…¶å®Œæˆã€‚
   - æ£€æŸ¥å‘½ä»¤çš„è¿”å›ç ï¼Œå¦‚æœä¸ä¸ºé›¶ï¼Œåˆ™è¾“å‡ºé”™è¯¯ä¿¡æ¯ã€‚

3. **ä¸»ç¨‹åºå…¥å£**ï¼š
   - å½“è„šæœ¬ä½œä¸ºä¸»ç¨‹åºè¿è¡Œæ—¶ï¼ŒæŒ‡å®šè¦è¿è¡Œçš„è„šæœ¬è·¯å¾„ï¼ˆæ­¤å¤„å‡è®¾ä¸º "web.py"ï¼‰ã€‚
   - è°ƒç”¨ `run_script` å‡½æ•°æ¥æ‰§è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½æ˜¯é€šè¿‡å½“å‰çš„ Python ç¯å¢ƒæ¥è¿è¡Œä¸€ä¸ªæŒ‡å®šçš„è„šæœ¬ï¼Œå…·ä½“æ¥è¯´æ˜¯ä¸€ä¸ªåä¸º `web.py` çš„è„šæœ¬ã€‚ç¨‹åºé¦–å…ˆå¯¼å…¥äº†å¿…è¦çš„æ¨¡å—ï¼ŒåŒ…æ‹¬ `sys`ã€`os` å’Œ `subprocess`ï¼Œè¿™äº›æ¨¡å—æä¾›äº†ä¸ç³»ç»Ÿäº¤äº’çš„åŠŸèƒ½ã€‚

åœ¨ `run_script` å‡½æ•°ä¸­ï¼Œé¦–å…ˆè·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿åœ¨æ­£ç¡®çš„ç¯å¢ƒä¸­è¿è¡Œè„šæœ¬ã€‚æ¥ç€ï¼Œæ„å»ºä¸€ä¸ªå‘½ä»¤å­—ç¬¦ä¸²ï¼Œè¯¥å‘½ä»¤ä½¿ç”¨ `streamlit` æ¥è¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚`streamlit` æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºæ•°æ®åº”ç”¨çš„åº“ï¼Œé€šå¸¸ç”¨äºå¿«é€Ÿåˆ›å»ºå¯è§†åŒ–åº”ç”¨ã€‚

ä½¿ç”¨ `subprocess.run` æ–¹æ³•æ¥æ‰§è¡Œæ„å»ºå¥½çš„å‘½ä»¤ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šåœ¨æ–°çš„ shell ä¸­è¿è¡Œå‘½ä»¤ï¼Œå¹¶ç­‰å¾…å…¶å®Œæˆã€‚å¦‚æœå‘½ä»¤æ‰§è¡Œåè¿”å›çš„çŠ¶æ€ç ä¸ä¸ºé›¶ï¼Œè¡¨ç¤ºè„šæœ¬è¿è¡Œè¿‡ç¨‹ä¸­å‡ºç°äº†é”™è¯¯ï¼Œæ­¤æ—¶ç¨‹åºä¼šæ‰“å°å‡ºä¸€æ¡é”™è¯¯ä¿¡æ¯ã€‚

åœ¨æ–‡ä»¶çš„æœ€åéƒ¨åˆ†ï¼Œä½¿ç”¨ `if __name__ == "__main__":` è¯­å¥æ¥ç¡®ä¿åªæœ‰åœ¨ç›´æ¥è¿è¡Œè¯¥æ–‡ä»¶æ—¶æ‰ä¼šæ‰§è¡Œä¸‹é¢çš„ä»£ç ã€‚è¿™éƒ¨åˆ†ä»£ç æŒ‡å®šäº†è¦è¿è¡Œçš„è„šæœ¬è·¯å¾„ï¼Œè°ƒç”¨ `abs_path` å‡½æ•°æ¥è·å– `web.py` çš„ç»å¯¹è·¯å¾„ï¼Œç„¶åè°ƒç”¨ `run_script` å‡½æ•°æ¥æ‰§è¡Œè¿™ä¸ªè„šæœ¬ã€‚

æ€»ä½“æ¥è¯´ï¼Œè¿™ä¸ªç¨‹åºçš„ç»“æ„ç®€å•æ˜äº†ï¼Œä¸»è¦ç”¨äºåœ¨æŒ‡å®šçš„ Python ç¯å¢ƒä¸­è¿è¡Œä¸€ä¸ª Streamlit åº”ç”¨è„šæœ¬ï¼Œå¹¶å¤„ç†å¯èƒ½å‡ºç°çš„é”™è¯¯ã€‚

#### 11.4 code\ultralytics\models\sam\modules\sam.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
from typing import List
import torch
from torch import nn

class Sam(nn.Module):
    """
    Sam (Segment Anything Model) æ˜¯ä¸€ä¸ªç”¨äºå¯¹è±¡åˆ†å‰²ä»»åŠ¡çš„æ¨¡å‹ã€‚å®ƒä½¿ç”¨å›¾åƒç¼–ç å™¨ç”Ÿæˆå›¾åƒåµŒå…¥ï¼Œå¹¶ä½¿ç”¨æç¤ºç¼–ç å™¨å¯¹å„ç§ç±»å‹çš„è¾“å…¥æç¤ºè¿›è¡Œç¼–ç ã€‚è¿™äº›åµŒå…¥éšåè¢«æ©ç è§£ç å™¨ç”¨äºé¢„æµ‹å¯¹è±¡æ©ç ã€‚
    """

    mask_threshold: float = 0.0  # æ©ç é¢„æµ‹çš„é˜ˆå€¼
    image_format: str = "RGB"     # è¾“å…¥å›¾åƒçš„æ ¼å¼ï¼Œé»˜è®¤ä¸º 'RGB'

    def __init__(
        self,
        image_encoder: ImageEncoderViT,  # å›¾åƒç¼–ç å™¨ï¼Œç”¨äºå°†å›¾åƒç¼–ç ä¸ºåµŒå…¥
        prompt_encoder: PromptEncoder,    # æç¤ºç¼–ç å™¨ï¼Œç”¨äºç¼–ç å„ç§ç±»å‹çš„è¾“å…¥æç¤º
        mask_decoder: MaskDecoder,        # æ©ç è§£ç å™¨ï¼Œä»å›¾åƒåµŒå…¥å’Œç¼–ç çš„æç¤ºä¸­é¢„æµ‹æ©ç 
        pixel_mean: List[float] = (123.675, 116.28, 103.53),  # è¾“å…¥å›¾åƒçš„å‡å€¼ï¼Œç”¨äºå½’ä¸€åŒ–
        pixel_std: List[float] = (58.395, 57.12, 57.375),      # è¾“å…¥å›¾åƒçš„æ ‡å‡†å·®ï¼Œç”¨äºå½’ä¸€åŒ–
    ) -> None:
        """
        åˆå§‹åŒ– Sam ç±»ï¼Œç”¨äºä»å›¾åƒå’Œè¾“å…¥æç¤ºä¸­é¢„æµ‹å¯¹è±¡æ©ç ã€‚

        å‚æ•°:
            image_encoder (ImageEncoderViT): ç”¨äºå°†å›¾åƒç¼–ç ä¸ºå›¾åƒåµŒå…¥çš„ä¸»å¹²ç½‘ç»œã€‚
            prompt_encoder (PromptEncoder): ç¼–ç å„ç§ç±»å‹çš„è¾“å…¥æç¤ºã€‚
            mask_decoder (MaskDecoder): ä»å›¾åƒåµŒå…¥å’Œç¼–ç çš„æç¤ºä¸­é¢„æµ‹æ©ç ã€‚
            pixel_mean (List[float], optional): ç”¨äºå½’ä¸€åŒ–è¾“å…¥å›¾åƒçš„å‡å€¼ï¼Œé»˜è®¤ä¸º (123.675, 116.28, 103.53)ã€‚
            pixel_std (List[float], optional): ç”¨äºå½’ä¸€åŒ–è¾“å…¥å›¾åƒçš„æ ‡å‡†å·®ï¼Œé»˜è®¤ä¸º (58.395, 57.12, 57.375)ã€‚
        """
        super().__init__()  # è°ƒç”¨çˆ¶ç±» nn.Module çš„åˆå§‹åŒ–æ–¹æ³•
        self.image_encoder = image_encoder  # ä¿å­˜å›¾åƒç¼–ç å™¨
        self.prompt_encoder = prompt_encoder  # ä¿å­˜æç¤ºç¼–ç å™¨
        self.mask_decoder = mask_decoder  # ä¿å­˜æ©ç è§£ç å™¨
        # æ³¨å†Œå‡å€¼å’Œæ ‡å‡†å·®ï¼Œç”¨äºå›¾åƒå½’ä¸€åŒ–
        self.register_buffer("pixel_mean", torch.Tensor(pixel_mean).view(-1, 1, 1), False)
        self.register_buffer("pixel_std", torch.Tensor(pixel_std).view(-1, 1, 1), False)
```

### ä»£ç è¯´æ˜ï¼š
1. **ç±»å®šä¹‰**ï¼š`Sam` ç±»ç»§æ‰¿è‡ª `nn.Module`ï¼Œç”¨äºå®ç°å¯¹è±¡åˆ†å‰²æ¨¡å‹ã€‚
2. **å±æ€§**ï¼š
   - `mask_threshold`ï¼šç”¨äºæ©ç é¢„æµ‹çš„é˜ˆå€¼ï¼Œå†³å®šäº†å“ªäº›åƒç´ è¢«è®¤ä¸ºæ˜¯ç›®æ ‡ã€‚
   - `image_format`ï¼šæŒ‡å®šè¾“å…¥å›¾åƒçš„æ ¼å¼ï¼Œé»˜è®¤ä¸º RGBã€‚
3. **åˆå§‹åŒ–æ–¹æ³•**ï¼š
   - æ¥æ”¶å›¾åƒç¼–ç å™¨ã€æç¤ºç¼–ç å™¨å’Œæ©ç è§£ç å™¨ä½œä¸ºå‚æ•°ï¼Œå¹¶å°†å®ƒä»¬ä¿å­˜ä¸ºç±»çš„å±æ€§ã€‚
   - `pixel_mean` å’Œ `pixel_std` ç”¨äºå›¾åƒçš„å½’ä¸€åŒ–å¤„ç†ï¼Œç¡®ä¿è¾“å…¥å›¾åƒåœ¨æ¨¡å‹è®­ç»ƒå’Œæ¨ç†æ—¶å…·æœ‰ä¸€è‡´çš„åˆ†å¸ƒã€‚
   - ä½¿ç”¨ `register_buffer` æ–¹æ³•å°†å‡å€¼å’Œæ ‡å‡†å·®æ³¨å†Œä¸ºæ¨¡å‹çš„ç¼“å†²åŒºï¼Œè¿™æ ·å®ƒä»¬åœ¨æ¨¡å‹ä¿å­˜å’ŒåŠ è½½æ—¶ä¼šè¢«ä¿ç•™ï¼Œä½†ä¸ä¼šè¢«è§†ä¸ºæ¨¡å‹çš„å‚æ•°ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªåä¸º `Sam` çš„ç±»ï¼Œå±äº Ultralytics YOLO é¡¹ç›®çš„ä¸€éƒ¨åˆ†ï¼Œä¸»è¦ç”¨äºå¯¹è±¡åˆ†å‰²ä»»åŠ¡ã€‚è¯¥ç±»ç»§æ‰¿è‡ª PyTorch çš„ `nn.Module`ï¼Œå¹¶åˆ©ç”¨å›¾åƒç¼–ç å™¨ã€æç¤ºç¼–ç å™¨å’Œæ©ç è§£ç å™¨æ¥å®ç°å›¾åƒçš„åˆ†å‰²ã€‚

åœ¨ç±»çš„æ–‡æ¡£å­—ç¬¦ä¸²ä¸­ï¼Œè¯¦ç»†æè¿°äº† `Sam` çš„åŠŸèƒ½å’Œå±æ€§ã€‚è¯¥æ¨¡å‹çš„æ ¸å¿ƒä»»åŠ¡æ˜¯ç”Ÿæˆå›¾åƒçš„åµŒå…¥è¡¨ç¤ºï¼Œå¹¶æ ¹æ®è¾“å…¥çš„æç¤ºï¼ˆå¦‚ç”¨æˆ·æä¾›çš„åŒºåŸŸæˆ–å¯¹è±¡ç±»å‹ï¼‰æ¥é¢„æµ‹å¯¹è±¡çš„æ©ç ã€‚å…·ä½“æ¥è¯´ï¼Œç±»çš„å±æ€§åŒ…æ‹¬ï¼š

- `mask_threshold`ï¼šç”¨äºæ©ç é¢„æµ‹çš„é˜ˆå€¼ã€‚
- `image_format`ï¼šè¾“å…¥å›¾åƒçš„æ ¼å¼ï¼Œé»˜è®¤ä¸º 'RGB'ã€‚
- `image_encoder`ï¼šä½¿ç”¨çš„å›¾åƒç¼–ç å™¨ï¼Œè¿™é‡Œæ˜¯ `ImageEncoderViT`ï¼Œç”¨äºå°†å›¾åƒç¼–ç ä¸ºåµŒå…¥ã€‚
- `prompt_encoder`ï¼šç”¨äºç¼–ç å„ç§ç±»å‹è¾“å…¥æç¤ºçš„ç¼–ç å™¨ã€‚
- `mask_decoder`ï¼šæ ¹æ®å›¾åƒå’Œæç¤ºçš„åµŒå…¥æ¥é¢„æµ‹å¯¹è±¡æ©ç çš„è§£ç å™¨ã€‚
- `pixel_mean` å’Œ `pixel_std`ï¼šç”¨äºå›¾åƒå½’ä¸€åŒ–çš„å‡å€¼å’Œæ ‡å‡†å·®ã€‚

åœ¨ `__init__` æ–¹æ³•ä¸­ï¼Œåˆå§‹åŒ–äº† `Sam` ç±»çš„å®ä¾‹ã€‚è¯¥æ–¹æ³•æ¥å—ä¸‰ä¸ªä¸»è¦å‚æ•°ï¼šå›¾åƒç¼–ç å™¨ã€æç¤ºç¼–ç å™¨å’Œæ©ç è§£ç å™¨ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥é€‰æ‹©æ€§åœ°ä¼ å…¥ç”¨äºå½’ä¸€åŒ–çš„å‡å€¼å’Œæ ‡å‡†å·®ã€‚é€šè¿‡è°ƒç”¨ `super().__init__()`ï¼Œç¡®ä¿çˆ¶ç±»çš„åˆå§‹åŒ–å¾—ä»¥æ‰§è¡Œã€‚`register_buffer` æ–¹æ³•ç”¨äºæ³¨å†Œå‡å€¼å’Œæ ‡å‡†å·®ï¼Œä½¿å…¶æˆä¸ºæ¨¡å‹çš„ä¸€éƒ¨åˆ†ï¼Œä½†ä¸è¢«è§†ä¸ºæ¨¡å‹çš„å‚æ•°ã€‚

æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªç±»çš„è®¾è®¡ç›®çš„æ˜¯ä¸ºå¯¹è±¡åˆ†å‰²ä»»åŠ¡æä¾›ä¸€ä¸ªçµæ´»çš„æ¡†æ¶ï¼Œé€šè¿‡ä¸åŒçš„ç¼–ç å™¨å’Œè§£ç å™¨ç»„åˆï¼Œèƒ½å¤Ÿå¤„ç†å¤šç§è¾“å…¥å’Œè¾“å‡ºéœ€æ±‚ã€‚

#### 11.5 train.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
class DetectionTrainer(BaseTrainer):
    """
    DetectionTrainerç±»æ‰©å±•äº†BaseTrainerç±»ï¼Œç”¨äºåŸºäºæ£€æµ‹æ¨¡å‹çš„è®­ç»ƒã€‚
    """

    def build_dataset(self, img_path, mode="train", batch=None):
        """
        æ„å»ºYOLOæ•°æ®é›†ã€‚

        å‚æ•°:
            img_path (str): åŒ…å«å›¾åƒçš„æ–‡ä»¶å¤¹è·¯å¾„ã€‚
            mode (str): æ¨¡å¼ï¼Œ`train`è¡¨ç¤ºè®­ç»ƒæ¨¡å¼ï¼Œ`val`è¡¨ç¤ºéªŒè¯æ¨¡å¼ï¼Œç”¨æˆ·å¯ä»¥ä¸ºæ¯ç§æ¨¡å¼è‡ªå®šä¹‰ä¸åŒçš„å¢å¼ºã€‚
            batch (int, optional): æ‰¹æ¬¡å¤§å°ï¼Œä»…ç”¨äº`rect`æ¨¡å¼ã€‚é»˜è®¤ä¸ºNoneã€‚
        """
        gs = max(int(de_parallel(self.model).stride.max() if self.model else 0), 32)
        return build_yolo_dataset(self.args, img_path, batch, self.data, mode=mode, rect=mode == "val", stride=gs)

    def get_dataloader(self, dataset_path, batch_size=16, rank=0, mode="train"):
        """æ„é€ å¹¶è¿”å›æ•°æ®åŠ è½½å™¨ã€‚"""
        assert mode in ["train", "val"]  # ç¡®ä¿æ¨¡å¼ä¸ºè®­ç»ƒæˆ–éªŒè¯
        with torch_distributed_zero_first(rank):  # å¦‚æœä½¿ç”¨åˆ†å¸ƒå¼æ•°æ®å¹¶è¡Œï¼ˆDDPï¼‰ï¼Œåªåˆå§‹åŒ–ä¸€æ¬¡æ•°æ®é›†
            dataset = self.build_dataset(dataset_path, mode, batch_size)
        shuffle = mode == "train"  # è®­ç»ƒæ¨¡å¼ä¸‹æ‰“ä¹±æ•°æ®
        if getattr(dataset, "rect", False) and shuffle:
            LOGGER.warning("WARNING âš ï¸ 'rect=True'ä¸DataLoaderçš„shuffleä¸å…¼å®¹ï¼Œè®¾ç½®shuffle=False")
            shuffle = False
        workers = self.args.workers if mode == "train" else self.args.workers * 2  # æ ¹æ®æ¨¡å¼è®¾ç½®å·¥ä½œçº¿ç¨‹æ•°
        return build_dataloader(dataset, batch_size, workers, shuffle, rank)  # è¿”å›æ•°æ®åŠ è½½å™¨

    def preprocess_batch(self, batch):
        """å¯¹ä¸€æ‰¹å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬ç¼©æ”¾å’Œè½¬æ¢ä¸ºæµ®ç‚¹æ•°ã€‚"""
        batch["img"] = batch["img"].to(self.device, non_blocking=True).float() / 255  # å°†å›¾åƒè½¬ç§»åˆ°è®¾å¤‡å¹¶å½’ä¸€åŒ–
        if self.args.multi_scale:  # å¦‚æœå¯ç”¨å¤šå°ºåº¦
            imgs = batch["img"]
            sz = (
                random.randrange(self.args.imgsz * 0.5, self.args.imgsz * 1.5 + self.stride)
                // self.stride
                * self.stride
            )  # éšæœºé€‰æ‹©ä¸€ä¸ªæ–°çš„å°ºå¯¸
            sf = sz / max(imgs.shape[2:])  # è®¡ç®—ç¼©æ”¾å› å­
            if sf != 1:  # å¦‚æœç¼©æ”¾å› å­ä¸ä¸º1
                ns = [
                    math.ceil(x * sf / self.stride) * self.stride for x in imgs.shape[2:]
                ]  # è®¡ç®—æ–°çš„å½¢çŠ¶
                imgs = nn.functional.interpolate(imgs, size=ns, mode="bilinear", align_corners=False)  # è¿›è¡Œæ’å€¼
            batch["img"] = imgs  # æ›´æ–°æ‰¹æ¬¡ä¸­çš„å›¾åƒ
        return batch

    def get_model(self, cfg=None, weights=None, verbose=True):
        """è¿”å›YOLOæ£€æµ‹æ¨¡å‹ã€‚"""
        model = DetectionModel(cfg, nc=self.data["nc"], verbose=verbose and RANK == -1)  # åˆ›å»ºæ£€æµ‹æ¨¡å‹
        if weights:
            model.load(weights)  # åŠ è½½æƒé‡
        return model

    def get_validator(self):
        """è¿”å›ç”¨äºYOLOæ¨¡å‹éªŒè¯çš„DetectionValidatorã€‚"""
        self.loss_names = "box_loss", "cls_loss", "dfl_loss"  # å®šä¹‰æŸå¤±åç§°
        return yolo.detect.DetectionValidator(
            self.test_loader, save_dir=self.save_dir, args=copy(self.args), _callbacks=self.callbacks
        )  # è¿”å›éªŒè¯å™¨

    def plot_training_samples(self, batch, ni):
        """ç»˜åˆ¶å¸¦æœ‰æ³¨é‡Šçš„è®­ç»ƒæ ·æœ¬ã€‚"""
        plot_images(
            images=batch["img"],
            batch_idx=batch["batch_idx"],
            cls=batch["cls"].squeeze(-1),
            bboxes=batch["bboxes"],
            paths=batch["im_file"],
            fname=self.save_dir / f"train_batch{ni}.jpg",
            on_plot=self.on_plot,
        )
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†è¯´æ˜ï¼š
1. **DetectionTrainerç±»**ï¼šç»§æ‰¿è‡ªBaseTrainerï¼Œä¸“é—¨ç”¨äºYOLOæ¨¡å‹çš„è®­ç»ƒã€‚
2. **build_datasetæ–¹æ³•**ï¼šæ„å»ºYOLOæ•°æ®é›†ï¼Œå¤„ç†å›¾åƒè·¯å¾„å’Œå¢å¼ºæ–¹å¼ã€‚
3. **get_dataloaderæ–¹æ³•**ï¼šæ„é€ æ•°æ®åŠ è½½å™¨ï¼Œæ”¯æŒè®­ç»ƒå’ŒéªŒè¯æ¨¡å¼ï¼Œå¤„ç†æ•°æ®æ‰“ä¹±å’Œå·¥ä½œçº¿ç¨‹ã€‚
4. **preprocess_batchæ–¹æ³•**ï¼šå¯¹å›¾åƒæ‰¹æ¬¡è¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬å½’ä¸€åŒ–å’Œå¤šå°ºåº¦è°ƒæ•´ã€‚
5. **get_modelæ–¹æ³•**ï¼šåˆ›å»ºå¹¶è¿”å›YOLOæ£€æµ‹æ¨¡å‹ï¼Œæ”¯æŒåŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚
6. **get_validatoræ–¹æ³•**ï¼šè¿”å›ç”¨äºæ¨¡å‹éªŒè¯çš„éªŒè¯å™¨ï¼Œå®šä¹‰æŸå¤±åç§°ã€‚
7. **plot_training_samplesæ–¹æ³•**ï¼šç»˜åˆ¶è®­ç»ƒæ ·æœ¬åŠå…¶æ³¨é‡Šï¼Œä¾¿äºå¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶ `train.py` æ˜¯ä¸€ä¸ªç”¨äºè®­ç»ƒç›®æ ‡æ£€æµ‹æ¨¡å‹çš„ä»£ç ï¼Œä¸»è¦åŸºäº YOLOï¼ˆYou Only Look Onceï¼‰æ¶æ„ã€‚æ–‡ä»¶ä¸­å¯¼å…¥äº†å¤šä¸ªå¿…è¦çš„åº“å’Œæ¨¡å—ï¼ŒåŒ…æ‹¬æ•°å­¦è¿ç®—ã€éšæœºæ•°ç”Ÿæˆã€æ·±åº¦å­¦ä¹ æ¡†æ¶ PyTorch ä»¥åŠä¸€äº›è‡ªå®šä¹‰çš„å·¥å…·å’Œæ¨¡å‹ã€‚

é¦–å…ˆï¼Œå®šä¹‰äº†ä¸€ä¸ªåä¸º `DetectionTrainer` çš„ç±»ï¼Œè¯¥ç±»ç»§æ‰¿è‡ª `BaseTrainer`ï¼Œç”¨äºå®ç°ç›®æ ‡æ£€æµ‹æ¨¡å‹çš„è®­ç»ƒã€‚ç±»çš„æ–‡æ¡£å­—ç¬¦ä¸²æä¾›äº†ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨è¯¥ç±»è¿›è¡Œè®­ç»ƒã€‚

åœ¨ `DetectionTrainer` ç±»ä¸­ï¼Œå®šä¹‰äº†å¤šä¸ªæ–¹æ³•ã€‚`build_dataset` æ–¹æ³•ç”¨äºæ„å»º YOLO æ•°æ®é›†ï¼Œæ¥æ”¶å›¾åƒè·¯å¾„ã€æ¨¡å¼ï¼ˆè®­ç»ƒæˆ–éªŒè¯ï¼‰å’Œæ‰¹é‡å¤§å°ä½œä¸ºå‚æ•°ã€‚è¯¥æ–¹æ³•ä¼šæ ¹æ®æ¨¡å‹çš„æ­¥å¹…ï¼ˆstrideï¼‰æ¥ç¡®å®šæ•°æ®é›†çš„æ„å»ºæ–¹å¼ã€‚

`get_dataloader` æ–¹æ³•ç”¨äºæ„å»ºæ•°æ®åŠ è½½å™¨ï¼Œç¡®ä¿åœ¨åˆ†å¸ƒå¼è®­ç»ƒä¸­åªåˆå§‹åŒ–ä¸€æ¬¡æ•°æ®é›†ï¼Œå¹¶æ ¹æ®æ¨¡å¼è®¾ç½®æ˜¯å¦æ‰“ä¹±æ•°æ®ã€‚è¯¥æ–¹æ³•è¿˜ä¼šæ ¹æ®æ¨¡å¼é€‰æ‹©åˆé€‚çš„å·¥ä½œçº¿ç¨‹æ•°ã€‚

`preprocess_batch` æ–¹æ³•ç”¨äºå¯¹å›¾åƒæ‰¹æ¬¡è¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬å°†å›¾åƒç¼©æ”¾åˆ°åˆé€‚çš„å¤§å°å¹¶è½¬æ¢ä¸ºæµ®ç‚¹æ•°æ ¼å¼ã€‚è¯¥æ–¹æ³•è¿˜æ”¯æŒå¤šå°ºåº¦è®­ç»ƒï¼Œé€šè¿‡éšæœºé€‰æ‹©å›¾åƒå¤§å°æ¥å¢å¼ºæ¨¡å‹çš„é²æ£’æ€§ã€‚

`set_model_attributes` æ–¹æ³•ç”¨äºè®¾ç½®æ¨¡å‹çš„å±æ€§ï¼ŒåŒ…æ‹¬ç±»åˆ«æ•°é‡å’Œç±»åˆ«åç§°ï¼Œä»¥ä¾¿æ¨¡å‹èƒ½å¤Ÿæ­£ç¡®å¤„ç†ä¸åŒçš„ç±»åˆ«ã€‚

`get_model` æ–¹æ³•ç”¨äºè¿”å›ä¸€ä¸ª YOLO æ£€æµ‹æ¨¡å‹ï¼Œå¯ä»¥é€‰æ‹©åŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚

`get_validator` æ–¹æ³•è¿”å›ä¸€ä¸ªç”¨äºæ¨¡å‹éªŒè¯çš„æ£€æµ‹éªŒè¯å™¨ï¼Œèƒ½å¤Ÿè®¡ç®—å¹¶è®°å½•æŸå¤±ã€‚

`label_loss_items` æ–¹æ³•ç”¨äºè¿”å›å¸¦æœ‰æ ‡ç­¾çš„è®­ç»ƒæŸå¤±é¡¹å­—å…¸ï¼Œä¾¿äºåç»­çš„æŸå¤±åˆ†æã€‚

`progress_string` æ–¹æ³•è¿”å›ä¸€ä¸ªæ ¼å¼åŒ–çš„å­—ç¬¦ä¸²ï¼Œæ˜¾ç¤ºè®­ç»ƒè¿›åº¦ï¼ŒåŒ…æ‹¬å½“å‰çš„ epochã€GPU å†…å­˜ä½¿ç”¨æƒ…å†µã€æŸå¤±å€¼ã€å®ä¾‹æ•°é‡å’Œå›¾åƒå¤§å°ã€‚

`plot_training_samples` æ–¹æ³•ç”¨äºç»˜åˆ¶è®­ç»ƒæ ·æœ¬åŠå…¶æ ‡æ³¨ï¼Œä¾¿äºå¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ•°æ®ã€‚

æœ€åï¼Œ`plot_metrics` å’Œ `plot_training_labels` æ–¹æ³•ç”¨äºç»˜åˆ¶è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŒ‡æ ‡å’Œæ ‡ç­¾ï¼Œå¸®åŠ©ç”¨æˆ·æ›´å¥½åœ°ç†è§£æ¨¡å‹çš„è®­ç»ƒæ•ˆæœã€‚

æ€»ä½“è€Œè¨€ï¼Œè¿™ä¸ªæ–‡ä»¶æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„æ¡†æ¶ï¼Œç”¨äºè®­ç»ƒ YOLO ç›®æ ‡æ£€æµ‹æ¨¡å‹ï¼Œæ¶µç›–äº†æ•°æ®é›†æ„å»ºã€æ•°æ®åŠ è½½ã€æ¨¡å‹è®¾ç½®ã€è®­ç»ƒè¿‡ç¨‹ç›‘æ§å’Œç»“æœå¯è§†åŒ–ç­‰å¤šä¸ªæ–¹é¢ã€‚

#### 11.6 70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\models\yolo\detect\val.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
class DetectionValidator(BaseValidator):
    """
    DetectionValidatorç±»ç”¨äºåŸºäºæ£€æµ‹æ¨¡å‹çš„éªŒè¯ï¼Œç»§æ‰¿è‡ªBaseValidatorç±»ã€‚
    """

    def __init__(self, dataloader=None, save_dir=None, pbar=None, args=None, _callbacks=None):
        """åˆå§‹åŒ–æ£€æµ‹æ¨¡å‹ï¼Œè®¾ç½®å¿…è¦çš„å˜é‡å’Œå‚æ•°ã€‚"""
        super().__init__(dataloader, save_dir, pbar, args, _callbacks)  # è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°
        self.nt_per_class = None  # æ¯ä¸ªç±»åˆ«çš„ç›®æ ‡æ•°é‡
        self.is_coco = False  # æ˜¯å¦ä¸ºCOCOæ•°æ®é›†
        self.class_map = None  # ç±»åˆ«æ˜ å°„
        self.args.task = 'detect'  # è®¾ç½®ä»»åŠ¡ç±»å‹ä¸ºæ£€æµ‹
        self.metrics = DetMetrics(save_dir=self.save_dir, on_plot=self.on_plot)  # åˆå§‹åŒ–æ£€æµ‹æŒ‡æ ‡
        self.iouv = torch.linspace(0.5, 0.95, 10)  # mAP@0.5:0.95çš„IoUå‘é‡
        self.niou = self.iouv.numel()  # IoUçš„æ•°é‡
        self.lb = []  # ç”¨äºè‡ªåŠ¨æ ‡æ³¨

    def preprocess(self, batch):
        """å¯¹YOLOè®­ç»ƒçš„å›¾åƒæ‰¹æ¬¡è¿›è¡Œé¢„å¤„ç†ã€‚"""
        # å°†å›¾åƒæ•°æ®ç§»åŠ¨åˆ°æŒ‡å®šè®¾å¤‡å¹¶è¿›è¡Œå½’ä¸€åŒ–å¤„ç†
        batch['img'] = batch['img'].to(self.device, non_blocking=True)
        batch['img'] = (batch['img'].half() if self.args.half else batch['img'].float()) / 255
        for k in ['batch_idx', 'cls', 'bboxes']:
            batch[k] = batch[k].to(self.device)  # å°†å…¶ä»–æ•°æ®ç§»åŠ¨åˆ°è®¾å¤‡

        # å¦‚æœéœ€è¦ä¿å­˜æ··åˆæ•°æ®ï¼Œè¿›è¡Œç›¸åº”å¤„ç†
        if self.args.save_hybrid:
            height, width = batch['img'].shape[2:]  # è·å–å›¾åƒçš„é«˜åº¦å’Œå®½åº¦
            nb = len(batch['img'])  # æ‰¹æ¬¡ä¸­çš„å›¾åƒæ•°é‡
            bboxes = batch['bboxes'] * torch.tensor((width, height, width, height), device=self.device)  # å½’ä¸€åŒ–è¾¹ç•Œæ¡†
            self.lb = [
                torch.cat([batch['cls'][batch['batch_idx'] == i], bboxes[batch['batch_idx'] == i]], dim=-1)
                for i in range(nb)] if self.args.save_hybrid else []  # è‡ªåŠ¨æ ‡æ³¨

        return batch  # è¿”å›å¤„ç†åçš„æ‰¹æ¬¡

    def postprocess(self, preds):
        """å¯¹é¢„æµ‹è¾“å‡ºåº”ç”¨éæå¤§å€¼æŠ‘åˆ¶ï¼ˆNMSï¼‰ã€‚"""
        return ops.non_max_suppression(preds,
                                       self.args.conf,
                                       self.args.iou,
                                       labels=self.lb,
                                       multi_label=True,
                                       agnostic=self.args.single_cls,
                                       max_det=self.args.max_det)  # è¿”å›ç»è¿‡NMSå¤„ç†çš„é¢„æµ‹ç»“æœ

    def update_metrics(self, preds, batch):
        """æ›´æ–°æ£€æµ‹æŒ‡æ ‡ã€‚"""
        for si, pred in enumerate(preds):  # éå†æ¯ä¸ªé¢„æµ‹
            idx = batch['batch_idx'] == si  # è·å–å½“å‰æ‰¹æ¬¡çš„ç´¢å¼•
            cls = batch['cls'][idx]  # è·å–å½“å‰æ‰¹æ¬¡çš„ç±»åˆ«
            bbox = batch['bboxes'][idx]  # è·å–å½“å‰æ‰¹æ¬¡çš„è¾¹ç•Œæ¡†
            nl, npr = cls.shape[0], pred.shape[0]  # æ ‡ç­¾æ•°é‡å’Œé¢„æµ‹æ•°é‡
            shape = batch['ori_shape'][si]  # åŸå§‹å›¾åƒçš„å½¢çŠ¶
            correct_bboxes = torch.zeros(npr, self.niou, dtype=torch.bool, device=self.device)  # åˆå§‹åŒ–æ­£ç¡®è¾¹ç•Œæ¡†
            self.seen += 1  # è®°å½•å·²å¤„ç†çš„å›¾åƒæ•°é‡

            if npr == 0:  # å¦‚æœæ²¡æœ‰é¢„æµ‹
                if nl:  # å¦‚æœæœ‰æ ‡ç­¾
                    self.stats.append((correct_bboxes, *torch.zeros((2, 0), device=self.device), cls.squeeze(-1)))
                continue  # ç»§ç»­ä¸‹ä¸€ä¸ªé¢„æµ‹

            # å¤„ç†é¢„æµ‹
            if self.args.single_cls:
                pred[:, 5] = 0  # å¦‚æœæ˜¯å•ç±»æ£€æµ‹ï¼Œå°†ç±»åˆ«è®¾ç½®ä¸º0
            predn = pred.clone()  # å…‹éš†é¢„æµ‹ç»“æœ
            ops.scale_boxes(batch['img'][si].shape[1:], predn[:, :4], shape,
                            ratio_pad=batch['ratio_pad'][si])  # å°†é¢„æµ‹æ¡†è½¬æ¢ä¸ºåŸå§‹å›¾åƒåæ ‡

            # è¯„ä¼°
            if nl:  # å¦‚æœæœ‰æ ‡ç­¾
                height, width = batch['img'].shape[2:]  # è·å–å›¾åƒçš„é«˜åº¦å’Œå®½åº¦
                tbox = ops.xywh2xyxy(bbox) * torch.tensor(
                    (width, height, width, height), device=self.device)  # è½¬æ¢æ ‡ç­¾æ¡†ä¸ºxyxyæ ¼å¼
                ops.scale_boxes(batch['img'][si].shape[1:], tbox, shape,
                                ratio_pad=batch['ratio_pad'][si])  # å°†æ ‡ç­¾æ¡†è½¬æ¢ä¸ºåŸå§‹å›¾åƒåæ ‡
                labelsn = torch.cat((cls, tbox), 1)  # åˆå¹¶æ ‡ç­¾å’Œè¾¹ç•Œæ¡†
                correct_bboxes = self._process_batch(predn, labelsn)  # å¤„ç†å½“å‰æ‰¹æ¬¡çš„é¢„æµ‹å’Œæ ‡ç­¾
            self.stats.append((correct_bboxes, pred[:, 4], pred[:, 5], cls.squeeze(-1)))  # è®°å½•å½“å‰æ‰¹æ¬¡çš„ç»Ÿè®¡ä¿¡æ¯

    def get_stats(self):
        """è¿”å›æŒ‡æ ‡ç»Ÿè®¡ä¿¡æ¯å’Œç»“æœå­—å…¸ã€‚"""
        stats = [torch.cat(x, 0).cpu().numpy() for x in zip(*self.stats)]  # è½¬æ¢ä¸ºnumpyæ•°ç»„
        if len(stats) and stats[0].any():  # å¦‚æœæœ‰ç»Ÿè®¡ä¿¡æ¯
            self.metrics.process(*stats)  # å¤„ç†æŒ‡æ ‡
        self.nt_per_class = np.bincount(stats[-1].astype(int), minlength=self.nc)  # è®¡ç®—æ¯ä¸ªç±»åˆ«çš„ç›®æ ‡æ•°é‡
        return self.metrics.results_dict  # è¿”å›ç»“æœå­—å…¸
```

### ä¸»è¦åŠŸèƒ½è¯´æ˜
1. **DetectionValidatorç±»**ï¼šç”¨äºå¤„ç†YOLOæ¨¡å‹çš„éªŒè¯ï¼Œç»§æ‰¿è‡ª`BaseValidator`ã€‚
2. **åˆå§‹åŒ–**ï¼šè®¾ç½®å„ç§å‚æ•°ï¼ŒåŒ…æ‹¬æ•°æ®åŠ è½½å™¨ã€ä¿å­˜ç›®å½•ã€æŒ‡æ ‡ç­‰ã€‚
3. **é¢„å¤„ç†**ï¼šå¯¹è¾“å…¥çš„å›¾åƒæ‰¹æ¬¡è¿›è¡Œå½’ä¸€åŒ–å’Œè®¾å¤‡è½¬æ¢ã€‚
4. **åå¤„ç†**ï¼šåº”ç”¨éæå¤§å€¼æŠ‘åˆ¶ï¼ˆNMSï¼‰æ¥è¿‡æ»¤é¢„æµ‹ç»“æœã€‚
5. **æ›´æ–°æŒ‡æ ‡**ï¼šæ ¹æ®é¢„æµ‹ç»“æœå’ŒçœŸå®æ ‡ç­¾æ›´æ–°æ£€æµ‹æŒ‡æ ‡ã€‚
6. **è·å–ç»Ÿè®¡ä¿¡æ¯**ï¼šè¿”å›å¤„ç†åçš„ç»Ÿè®¡ä¿¡æ¯å’Œç»“æœå­—å…¸ã€‚

ä»¥ä¸Šæ˜¯ä»£ç çš„æ ¸å¿ƒéƒ¨åˆ†åŠå…¶è¯¦ç»†æ³¨é‡Šï¼Œå¸®åŠ©ç†è§£YOLOæ¨¡å‹çš„éªŒè¯è¿‡ç¨‹ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶æ˜¯ç”¨äºYOLOv8ç›®æ ‡æ£€æµ‹æ¨¡å‹çš„éªŒè¯è¿‡ç¨‹ï¼Œä¸»è¦å®ç°äº†å¯¹æ¨¡å‹åœ¨éªŒè¯é›†ä¸Šçš„æ€§èƒ½è¯„ä¼°ã€‚ç¨‹åºé¦–å…ˆå¯¼å…¥äº†å¿…è¦çš„åº“å’Œæ¨¡å—ï¼ŒåŒ…æ‹¬PyTorchã€NumPyä»¥åŠUltralyticsåº“ä¸­çš„å„ç§å·¥å…·å’Œç±»ã€‚

åœ¨ç¨‹åºä¸­ï¼Œ`DetectionValidator`ç±»ç»§æ‰¿è‡ª`BaseValidator`ç±»ï¼Œä¸“é—¨ç”¨äºå¤„ç†åŸºäºYOLOæ¨¡å‹çš„éªŒè¯ã€‚è¯¥ç±»çš„æ„é€ å‡½æ•°åˆå§‹åŒ–äº†ä¸€äº›é‡è¦çš„å˜é‡å’Œè®¾ç½®ï¼ŒåŒ…æ‹¬æ•°æ®åŠ è½½å™¨ã€ä¿å­˜ç›®å½•ã€è¿›åº¦æ¡ã€å‚æ•°ç­‰ã€‚å®ƒè¿˜å®šä¹‰äº†ä¸€äº›ç”¨äºè®¡ç®—æŒ‡æ ‡çš„å˜é‡ï¼Œå¦‚`DetMetrics`ç”¨äºå­˜å‚¨æ£€æµ‹æŒ‡æ ‡ï¼Œ`iou`ç”¨äºè®¡ç®—ä¸åŒé˜ˆå€¼ä¸‹çš„å¹³å‡ç²¾åº¦ï¼ˆmAPï¼‰ã€‚

`preprocess`æ–¹æ³•è´Ÿè´£å¯¹è¾“å…¥çš„å›¾åƒæ‰¹æ¬¡è¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬å°†å›¾åƒè½¬æ¢ä¸ºé€‚åˆæ¨¡å‹è¾“å…¥çš„æ ¼å¼ï¼Œå¹¶å°†æ ‡ç­¾å’Œè¾¹ç•Œæ¡†è½¬æ¢åˆ°è®¾å¤‡ä¸Šã€‚`init_metrics`æ–¹æ³•åˆ™åˆå§‹åŒ–éªŒè¯æ‰€éœ€çš„è¯„ä¼°æŒ‡æ ‡ï¼ŒåŒ…æ‹¬æ˜¯å¦ä½¿ç”¨COCOæ•°æ®é›†ã€ç±»åˆ«æ˜ å°„ç­‰ã€‚

åœ¨æ¨¡å‹è¿›è¡Œé¢„æµ‹åï¼Œ`postprocess`æ–¹æ³•åº”ç”¨éæå¤§å€¼æŠ‘åˆ¶ï¼ˆNMSï¼‰æ¥è¿‡æ»¤æ‰é‡å çš„æ£€æµ‹ç»“æœã€‚`update_metrics`æ–¹æ³•ç”¨äºæ›´æ–°æ£€æµ‹æŒ‡æ ‡ï¼Œè®¡ç®—æ­£ç¡®çš„è¾¹ç•Œæ¡†ï¼Œå¹¶è®°å½•æ¯ä¸ªç±»åˆ«çš„ç»Ÿè®¡ä¿¡æ¯ã€‚

`finalize_metrics`æ–¹æ³•è®¾ç½®æœ€ç»ˆçš„æŒ‡æ ‡å€¼ï¼Œè€Œ`get_stats`æ–¹æ³•åˆ™è¿”å›å½“å‰çš„ç»Ÿè®¡ä¿¡æ¯å’Œç»“æœå­—å…¸ã€‚`print_results`æ–¹æ³•ç”¨äºæ‰“å°æ¯ä¸ªç±»åˆ«çš„è®­ç»ƒå’ŒéªŒè¯é›†æŒ‡æ ‡ï¼Œæä¾›äº†è¯¦ç»†çš„ç»“æœè¾“å‡ºã€‚

æ­¤å¤–ï¼Œç¨‹åºè¿˜åŒ…å«äº†ä¸€äº›è¾…åŠ©æ–¹æ³•ï¼Œä¾‹å¦‚`build_dataset`å’Œ`get_dataloader`ç”¨äºæ„å»ºæ•°æ®é›†å’Œæ•°æ®åŠ è½½å™¨ï¼Œ`plot_val_samples`å’Œ`plot_predictions`ç”¨äºå¯è§†åŒ–éªŒè¯æ ·æœ¬å’Œé¢„æµ‹ç»“æœï¼Œ`save_one_txt`å’Œ`pred_to_json`ç”¨äºå°†æ£€æµ‹ç»“æœä¿å­˜ä¸ºæ–‡æœ¬æ–‡ä»¶æˆ–JSONæ ¼å¼ã€‚

æœ€åï¼Œ`eval_json`æ–¹æ³•ç”¨äºè¯„ä¼°YOLOè¾“å‡ºçš„JSONæ ¼å¼ç»“æœï¼Œå¹¶è¿”å›æ€§èƒ½ç»Ÿè®¡ä¿¡æ¯ï¼Œç‰¹åˆ«æ˜¯ä¸COCOæ•°æ®é›†ç›¸å…³çš„è¯„ä¼°ã€‚

æ€»ä½“æ¥è¯´ï¼Œè¿™ä¸ªç¨‹åºæ–‡ä»¶å®ç°äº†YOLOv8æ¨¡å‹åœ¨éªŒè¯é›†ä¸Šçš„å®Œæ•´è¯„ä¼°æµç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®é¢„å¤„ç†ã€æ¨¡å‹é¢„æµ‹ã€æŒ‡æ ‡è®¡ç®—å’Œç»“æœè¾“å‡ºç­‰æ­¥éª¤ã€‚

### 12.ç³»ç»Ÿæ•´ä½“ç»“æ„ï¼ˆèŠ‚é€‰ï¼‰

### æ•´ä½“åŠŸèƒ½å’Œæ„æ¶æ¦‚æ‹¬

è¯¥é¡¹ç›®æ˜¯ä¸€ä¸ªå®Œæ•´çš„YOLOv8ç›®æ ‡æ£€æµ‹æ¡†æ¶ï¼Œæä¾›äº†ä»æ¨¡å‹è®­ç»ƒã€éªŒè¯åˆ°å¯è§†åŒ–çš„å…¨æµç¨‹æ”¯æŒã€‚å®ƒçš„æ ¸å¿ƒåŠŸèƒ½åŒ…æ‹¬æ•°æ®é›†æ„å»ºã€æ¨¡å‹è®­ç»ƒã€éªŒè¯ã€æ€§èƒ½è¯„ä¼°ä»¥åŠå¯è§†åŒ–å·¥å…·çš„é›†æˆã€‚é€šè¿‡ä¸åŒçš„æ¨¡å—å’Œç±»ï¼Œé¡¹ç›®å®ç°äº†çµæ´»çš„æ¶æ„ï¼Œå…è®¸ç”¨æˆ·è‡ªå®šä¹‰è®­ç»ƒå‚æ•°ã€æ¨¡å‹ç»“æ„å’Œæ•°æ®å¤„ç†æ–¹å¼ã€‚

é¡¹ç›®çš„ä¸»è¦ç»„æˆéƒ¨åˆ†åŒ…æ‹¬ï¼š

1. **æ¨¡å‹å®šä¹‰ä¸æ„å»º**ï¼šå®šä¹‰äº†YOLOv8åŠå…¶å˜ç§çš„æ¨¡å‹ç»“æ„ã€‚
2. **è®­ç»ƒä¸éªŒè¯**ï¼šæä¾›äº†è®­ç»ƒå’ŒéªŒè¯çš„é€»è¾‘ï¼ŒåŒ…æ‹¬æ•°æ®åŠ è½½ã€æŸå¤±è®¡ç®—å’Œæ€§èƒ½è¯„ä¼°ã€‚
3. **å¯è§†åŒ–å·¥å…·**ï¼šé›†æˆäº†TensorBoardç­‰å·¥å…·ï¼Œç”¨äºå®æ—¶ç›‘æ§è®­ç»ƒè¿‡ç¨‹å’Œç»“æœã€‚
4. **å®ç”¨å·¥å…·**ï¼šæä¾›äº†ä¸€äº›è¾…åŠ©åŠŸèƒ½ï¼Œå¦‚æ•°æ®é¢„å¤„ç†ã€ç»“æœä¿å­˜å’Œå¯è§†åŒ–ç­‰ã€‚

### æ–‡ä»¶åŠŸèƒ½æ•´ç†è¡¨

| æ–‡ä»¶è·¯å¾„                                                                                          | åŠŸèƒ½æè¿°                                                         |
|---------------------------------------------------------------------------------------------------|------------------------------------------------------------------|
| `ultralytics/utils/callbacks/tensorboard.py`                                                    | å®ç°TensorBoardå›è°ƒåŠŸèƒ½ï¼Œç”¨äºè®°å½•å’Œå¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŒ‡æ ‡ã€‚   |
| `ultralytics/__init__.py`                                                                        | åˆå§‹åŒ–æ¨¡å—ï¼Œå¯¼å…¥YOLOåŠç›¸å…³æ¨¡å‹å’Œå·¥å…·ï¼Œæä¾›å…¬å…±æ¥å£ã€‚           |
| `ui.py`                                                                                           | è¿è¡ŒæŒ‡å®šçš„Streamlitåº”ç”¨è„šæœ¬ï¼Œç”¨äºå¯è§†åŒ–ç•Œé¢ã€‚                   |
| `ultralytics/models/sam/modules/sam.py`                                                          | å®šä¹‰`Sam`ç±»ï¼Œç”¨äºå¯¹è±¡åˆ†å‰²ä»»åŠ¡ï¼ŒåŒ…å«å›¾åƒå’Œæç¤ºç¼–ç å™¨ã€‚          |
| `train.py`                                                                                        | å®ç°YOLOç›®æ ‡æ£€æµ‹æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®é›†æ„å»ºå’Œè®­ç»ƒé€»è¾‘ã€‚     |
| `ultralytics/models/yolo/detect/val.py`                                                          | å®ç°YOLOæ¨¡å‹çš„éªŒè¯è¿‡ç¨‹ï¼Œè®¡ç®—å’Œè¾“å‡ºæ€§èƒ½æŒ‡æ ‡ã€‚                   |
| `ultralytics/utils/callbacks/__init__.py`                                                       | åˆå§‹åŒ–å›è°ƒæ¨¡å—ï¼Œç®¡ç†å’Œç»„ç»‡ä¸åŒçš„å›è°ƒåŠŸèƒ½ã€‚                     |
| `ultralytics/models/yolo/__init__.py`                                                            | åˆå§‹åŒ–YOLOæ¨¡å‹æ¨¡å—ï¼Œå¯¼å…¥ç›¸å…³åŠŸèƒ½å’Œç±»ã€‚                         |
| `code/ultralytics/trackers/basetrack.py`                                                         | å®ç°åŸºç¡€è·Ÿè¸ªå™¨åŠŸèƒ½ï¼Œç”¨äºç›®æ ‡è·Ÿè¸ªä»»åŠ¡ã€‚                         |
| `ultralytics/models/yolo/segment/val.py`                                                         | å®ç°YOLOåˆ†å‰²æ¨¡å‹çš„éªŒè¯è¿‡ç¨‹ï¼Œè¯„ä¼°åˆ†å‰²æ€§èƒ½ã€‚                     |
| `code/ultralytics/engine/trainer.py`                                                             | å®šä¹‰è®­ç»ƒå¼•æ“ï¼Œç®¡ç†è®­ç»ƒè¿‡ç¨‹ä¸­çš„å„ä¸ªç¯èŠ‚ã€‚                       |
| `ultralytics/hub/auth.py`                                                                         | å¤„ç†æ¨¡å‹çš„è®¤è¯å’Œä¸‹è½½åŠŸèƒ½ã€‚                                     |
| `code/ultralytics/utils/torch_utils.py`                                                          | æä¾›ä¸PyTorchç›¸å…³çš„å®ç”¨å·¥å…·å‡½æ•°ï¼Œè¾…åŠ©æ¨¡å‹è®­ç»ƒå’Œæ¨ç†ã€‚         |

ä»¥ä¸Šè¡¨æ ¼æ€»ç»“äº†é¡¹ç›®ä¸­å„ä¸ªæ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½ï¼Œå¸®åŠ©ç”¨æˆ·å¿«é€Ÿç†è§£é¡¹ç›®ç»“æ„å’Œå„ä¸ªæ¨¡å—çš„ä½œç”¨ã€‚

æ³¨æ„ï¼šç”±äºæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰â€ä¸­éƒ¨åˆ†ä»£ç å¯èƒ½ä¼šä¼˜åŒ–å‡çº§ï¼Œä»…ä¾›å‚è€ƒå­¦ä¹ ï¼Œå®Œæ•´â€œè®­ç»ƒæºç â€ã€â€œWebå‰ç«¯ç•Œé¢â€å’Œâ€œ70+ç§åˆ›æ–°ç‚¹æºç â€ä»¥â€œ13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†è·å–â€çš„å†…å®¹ä¸ºå‡†ã€‚

### 13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†è·å–

![19.png](19.png)


# [ä¸‹è½½é“¾æ¥ï¼šhttps://mbd.pub/o/bread/ZpuUmZdx](https://mbd.pub/o/bread/ZpuUmZdx)